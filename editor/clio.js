(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){const treeify=require("treeify");const lexer=require("./lexer/lexer");const parser=require("./parser/parser");const analyzer=require("./evaluator/analyzer");var builtins=require("./internals/builtins");function remove_props(obj,keys){if(obj instanceof Array){obj.forEach(function(item){remove_props(item,keys)})}else if(typeof obj==="object"){Object.getOwnPropertyNames(obj).forEach(function(key){if(keys.indexOf(key)!==-1){delete obj[key]}else{remove_props(obj[key],keys)}})}}function print_ast(ast,printfn){remove_props(ast,"index");printfn(treeify.asTree(ast,true))}async function clio_process_source(source,out,info,printfn){var tokens=lexer(source);if(tokens[0]==false){return}tokens=tokens[1];var t1=(new Date).getTime();var result=parser(source,tokens);var t2=(new Date).getTime();var ast=result[1];if(out=="ast"){if(info){printfn(`Ast time: ${(t2-t1)/1e3}s`)}print_ast(ast,printfn)}else{ast.pop();var code=analyzer(ast,source);var t3=(new Date).getTime();if(out=="run"){var module={};eval(code);builtins.print=async function(...args){var args=await Promise.all(args.map(a=>builtins.string(a,true)).map(builtins.value));printfn(...args);return args[0]};await module.exports({$:$},builtins)}var t4=(new Date).getTime();if(info){setTimeout(function(){printfn();printfn("-----------------------------------------");printfn(`Ast time:\t${(t2-t1)/1e3}s`);printfn(`Compile time:\t${(t3-t2)/1e3}s`);printfn(`Eval time:\t${(t4-t3)/1e3}s`)},1)}}}window.clio_process_source=clio_process_source;document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('script[type="text/clio"]').forEach(function(el){var source=el.innerHTML;clio_process_source(source,"run",false)})})},{"./evaluator/analyzer":3,"./internals/builtins":4,"./lexer/lexer":7,"./parser/parser":22,treeify:19}],2:[function(require,module,exports){(function(process){var chalk=require("chalk");class ClioException extends Error{constructor(e,stack){super(e.message);this.clio_stack=stack;Error.captureStackTrace(this,ClioException)}add_to_stack(file,trace){this.clio_stack.push({file:file,trace:trace})}exit(){this.print_stack();process.exit_code=1}print_stack(){console.log();this.clio_stack.forEach(function(stack){resolve_and_print(stack.file.source,stack.file.name,stack.trace.fn,stack.trace.index)});var message=chalk.red(` Exception: ${this.message}\n`);console.log(message)}}function exception_handler(e,call){if(e.constructor==ClioException){if(call.clio_stack){e.clio_stack=[...e.clio_stack,...call.clio_stack]}}if(e.constructor!=ClioException){e=new ClioException(e,call.clio_stack)}throw e}function resolve_and_print(code,file,fn,index){var all_lines=code.split("\n");var lines=[];var count=0;var chars_before_line=0;var line;while(count<=index){line=all_lines.shift();lines.push(line);count+=line.length+1;if(count<=index){chars_before_line=count}}var last_three_lines=lines.slice(Math.max(lines.length-3,0));var chars=lines.reduce(function(memo,line){return memo+line.length+1},0);var error_at_line=lines.length;var error_at_char=index-chars_before_line;var line_name_len=error_at_line.toString().length;var line_number;file=chalk.green(`"${file}"`);fn=chalk.magenta.italic(fn);var message=chalk.cyan(` At file ${file} when calling ${fn}:\n`);console.log(message);while(last_three_lines.length>0){line=last_three_lines.shift();line_number=error_at_line-last_three_lines.length;line_number=line_number.toString().padStart(line_name_len," ");line_number=chalk.cyan(line_number);line=chalk.cyanBright(`   ${line_number} ${chalk.gray("â”‚")} ${line}`);console.log(line)}var pad=new Array(line_name_len+6+error_at_char).join(" ");error_at_line=chalk.yellow(error_at_line);error_at_char=chalk.yellow(error_at_char);message=chalk.cyan(`${pad} ^ At line ${error_at_line} char ${error_at_char}`);console.log(message);console.log()}function throw_error(code,error,index){var all_lines=code.split("\n");var lines=[];var count=0;var line;while(count<=index){line=all_lines.shift();lines.push(line);count+=line.length+1}var last_three_lines=lines.slice(Math.max(lines.length-3,0));var chars=lines.reduce(function(memo,line){return memo+line.length+1},0);var error_at_line=lines.length;var error_at_char=index-(chars-last_three_lines[last_three_lines.length-1].length)+1;var line_name_len=error_at_line.toString().length;var line_number;console.log();while(last_three_lines.length>0){line=last_three_lines.shift();line_number=error_at_line-last_three_lines.length;line_number=line_number.toString().padStart(line_name_len," ");console.log(`${line_number} â”‚ ${line}`)}var pad=new Array(line_name_len+3+error_at_char).join(" ");console.log(`${pad} ^ Exception at line ${error_at_line} char ${error_at_char}`);console.log(`${pad}   ${error}`);console.log()}function cast_to_bool(a){switch(typeof a){case"boolean":return a;case"string":return a!="";case"array":return a!=[];case"object":if(a instanceof Array){return a!=[]}return a!={};case"number":return a!=0;case"function":return true;default:return false}}exports.throw_error=throw_error;exports.exception_handler=exception_handler;exports.ClioException=ClioException;exports.cast_to_bool=cast_to_bool}).call(this,require("_process"))},{_process:25,chalk:9}],3:[function(require,module,exports){const unescapeJs=require("unescape-js");const cast_to_bool=require("../common").cast_to_bool;var Decimal=require("decimal.js");function analyzer(tree,source){function make_return(expr){if(expr.name=="conditional"){var tokens=expr.tokens.map(make_return);expr.tokens=tokens;return expr}else if(["if_statement","elif_statement","else_statement"].includes(expr.name)){var block=expr.tokens[expr.tokens.length-1];if(block.name!="block"){block={name:"block",tokens:[block]}}var last_expr=block.tokens[block.tokens.length-1];var redefined=make_return(last_expr);block.tokens[block.tokens.length-1]=redefined;expr.tokens[expr.tokens.length-1]=block;return expr}return{name:"return",tokens:[expr]}}const analyzers={return:function(node){var code=analyze(node.tokens[0]).code;return{code:`return ${code}`}},number:function(node){node.raw=node.raw.replace(/'/g,"");return{code:`builtins.Decimal('${node.raw}')`}},bool:function(node){return{code:node.raw}},symbol:function(node){return{code:`await builtins.funcall(['${node.raw}'], [scope], builtins.get_symbol, file, {index: ${node.index}, fn: '<get-symbol>'})`}},property_access:function(node){node.tokens=node.tokens.map(token=>{token.raw=token.raw.replace(/'s?$/,"");if(token.raw=="my"){token.raw="self"}return token.raw});var first=node.tokens.shift();var code=`(new builtins.lazy_call(async () => (await builtins.value(scope['${first}'] || builtins['${first}']))))`;node.tokens.forEach(function(token){code=`(new builtins.lazy_call(async () => (await builtins.value(${code}))['${token}']))`});return{code:code}},string:function(node){return{code:`\`${unescapeJs(node.raw).slice(1,-1)}\``}},word:function(node){return{code:`'${node.raw.slice(1)}'`}},atsign:function(node){return{code:"(new builtins.AtSign(0))"}},atnumber:function(node){return{code:`(new builtins.AtSign(${node.tokens[1].raw}))`}},notexpr:function(node){var right=analyze(node.tokens[0]).code;return{code:`(builtins.funcall([${right}], [], builtins.not, file, {index: ${node.index}, fn: '<not>'}))`}},and_or_expr:function(node){var tokens=analyze(node.tokens);var left=tokens[0].code;var right=tokens[2].code;var cmp=tokens[1];return{code:`((${left}) ${cmp} (${right}))`}},wrapped_not:function(node){return analyze(node.tokens[0])},wrapped_and_or:function(node){return analyze(node.tokens[0])},or:function(node){return"||"},and:function(node){return"&&"},not:function(node){return"!"},list:function(node){var inner=node.tokens.map(function(token){return analyze(token).code}).join(", ");var list=`[${inner}]`;return{code:`new builtins.Generator(\n          (i, self) => self.data[i],\n          ${list},\n          self => self.data.length,\n        )`}},range:function(node){var start=node.tokens[0].tokens.length?node.tokens[0].tokens[0]:{name:"number",raw:"0"};var end=node.tokens.length>1?node.tokens[1]:{name:"number",raw:"Infinity"};var start=analyze(start).code;var end=analyze(end).code;var step=`builtins.Decimal(builtins.Decimal(${start}).lt(builtins.Decimal(${end}))?1:-1)`;return{code:`new builtins.Generator(\n          (i, self) => self.data.start.add(self.data.step.mul(i)),\n          {start:${start}, end:${end}, step:${step}},\n          self => self.data.start.sub(self.data.end).div(self.data.step).abs().add(1),\n        )`}},stepped_range:function(node){var start=node.tokens[0].tokens.length?node.tokens[0].tokens[0]:{name:"number",raw:"0"};var end=node.tokens.length>2?node.tokens[1]:{name:"number",raw:"Inf"};var step=node.tokens[2];var start=analyze(start).code;var end=analyze(end).code;var step=analyze(step).code;return{code:`new builtins.Generator(\n          (i, self) => self.data.start.add(self.data.step.mul(i)),\n          {start:${start}, end:${end}, step:${step}},\n          self => self.data.start.sub(self.data.end).div(self.data.step).abs().add(1),\n        )`}},slice:function(node){var list=analyze(node.tokens.shift());var slicers=node.tokens.pop();var index=slicers.index;var slicers=slicers.tokens;var slicers=analyze(slicers).map(s=>s.code).join(", ");return{code:`builtins.funcall([${list.code}], [[${slicers}], 0], builtins.slice, file, {index: ${index}, fn: 'builtins.slice'})`}},comparison:function(node){return node.raw},cmpexpr:function(node){var tokens=analyze(node.tokens);var left=tokens[0];var right=tokens[2];var cmp=tokens[1];const funcs={"=":"builtins.eq",">":"builtins.gt",">=":"builtins.gte","<":"builtins.lt","<=":"builtins.lte"};var func=funcs[cmp];return{code:`await builtins.funcall([${left.code}], [${right.code}], ${func}, file, {index: ${node.index}, fn: '${func}'})`}},import_st:function(node){var names_to_import=node.tokens.slice(0,-1).map(t=>t.raw);var from=node.tokens[node.tokens.length-1].tokens[0];if(from.name=="url"){var code=names_to_import.map(function(symbol){return`scope['${symbol}'] = builtins.lazy(function (...args) {\n            return builtins.cloud_call('${from.raw}', '${symbol}', args, {});\n          }, true);\n          scope['${symbol}.is_cloud'] = true`}).join(";\n")}else{var stringified_names_to_import=names_to_import.map(a=>`'${a}'`).join(", ");var code=`await builtins.clio_require('${from.raw}', [${stringified_names_to_import}], __dirname, scope)`}return{code:code}},import_nk:function(node){var imports=node.tokens.map(function(mod){return`await builtins.clio_require('${mod.raw}', [], __dirname, scope)`});return{code:imports.join(";\n")}},wrapped_quickfundef:function(node){return analyze(node.tokens[0])},quickfundef:function(node){node.tokens.unshift({name:"symbol",raw:""});node.name="fundef";node.tokens[2]={name:"block",tokens:[node.tokens[2]]};var func_code=analyze(node).code;return{code:func_code}},inflowfundef:function(node){node.tokens.unshift({name:"symbol",raw:""});node.name="fundef";var func_code=analyze(node).code;return{type:"inflowfundef",code:func_code}},decorated_inflowfundef:function(node){var block=node.tokens.pop();var arg=node.tokens.pop();var func=analyze({name:"inflowfundef",tokens:[arg,block]});var code=func.code;while(node.tokens.length){token=node.tokens.pop().tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code=`builtins.decorate_function(${name}, [${args}], ${code}, '', scope)`}return{code:code,type:func.type}},starinflowfundef:function(node){node.tokens.unshift({name:"symbol",raw:""});node.name="fundef";var func_code=analyze(node).code;return{type:"starinflowfundef",code:func_code}},decorated_starinflowfundef:function(node){var block=node.tokens.pop();var arg=node.tokens.pop();var func=analyze({name:"starinflowfundef",tokens:[arg,block]});var code=func.code;while(node.tokens.length){token=node.tokens.pop().tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code=`builtins.decorate_function(${name}, [${args}], ${code}, '', scope)`}return{code:code,type:func.type}},startransform:function(node){var transform=node.tokens[0].tokens[1];transform.tokens[0]={name:"symbol",raw:""};transform.name="fundef";if(transform.tokens[1].name=="atnum_as"){var index=transform.tokens[1].tokens[0].tokens[1].raw;transform.tokens[1]={name:"symbol",raw:transform.tokens[1].tokens[1].raw}}else{var index="0"}transform.tokens[2]={name:"block",tokens:[transform.tokens[2]]};var func_code=analyze(transform).code;return{code:`(new builtins.Transform(${func_code}, ${index}, true))`}},transform:function(node){var transform=node.tokens[0];transform.tokens[0]={name:"symbol",raw:""};transform.name="fundef";if(transform.tokens[1].name=="atnum_as"){var index=transform.tokens[1].tokens[0].tokens[1].raw;transform.tokens[1]={name:"symbol",raw:transform.tokens[1].tokens[1].raw}}else{var index="0"}if(transform.tokens[2].name=="symbol"){var data=transform.tokens[1];var fn=transform.tokens[2];var flow={name:"flow",tokens:[data,{name:"naked_mapper",tokens:[fn]}]};transform.tokens[2]=flow}transform.tokens[2]={name:"block",tokens:[transform.tokens[2]]};var func_code=analyze(transform).code;return{code:`(new builtins.Transform(${func_code}, ${index}, false))`}},flow:function(node){var tokens=analyze(node.tokens);var data=[];var function_calls=["setter","mapper","starmapper","naked_mapper","naked_star_mapper","filter","starinflowfundef","inflowfundef","starinflowprocdef","inflowprocdef","condmapper","decorated_starinflowfundef","starcondmapper","quickfundef","starquickfundef","return_mapper","fundef","decorated_inflowfundef"];var i=0;while(!function_calls.includes(node.tokens[i++].name)){data.push(tokens.shift())}data=data.map(d=>d.code).join(", ");var code=`${data}`;var variables=[];tokens.forEach(function(token){if(token.type=="setter"){code=`(scope${token.code} = ${code})`;variables.push(token.code)}else if(token.type=="filter"){code=`await builtins.filter([${code}], ${token.code})`}else if(token.type=="return"){code=`return await ${code};`}else if(token.type=="map"){code=`await builtins.starmap([${code}], ${token.code[0]}, ${token.code[1]})`}else if(["inflowfundef","inflowprocdef"].includes(token.type)){code=`await builtins.funcall([${code}], [], ${token.code}, file, {index: ${node.index}, fn: '<anonymous-fn>'})`}else if(["starinflowfundef","starinflowprocdef"].includes(token.type)){code=`await builtins.starmap([${code}], ${token.code}, [])`}else if(token.type=="condmapper"){code=`await builtins.funcall([${code}], [], ${token.code}, file, {index: ${node.index}, fn: '<conditional>'})`}else if(token.type=="starcondmapper"){code=`await builtins.starmap([${code}], ${token.code}, [])`}else{code=`await builtins.funcall([${code}], ${token.code[1]}, ${token.code[0]}, file, {index: ${token.fnindex}, fn: '${token.fn}'})`}});return{code:code,vars:variables}},wrapped_flow:function(node){var res=analyze(node.tokens[0]);return{code:res.code,vars:res.vars}},setter:function(node){if(node.tokens[0].name=="symbol"){var variable=`['${node.tokens[0].raw}']`}else if(node.tokens[0].name=="property_access"){var tokens=node.tokens[0].tokens.map(token=>{token.raw=token.raw.replace(/'s?$/,"");if(token.raw=="my"){token.raw="self"}return token.raw});var first=tokens.shift();var code=`['${first}']`;tokens.forEach(function(token){variable=`${code}['${token}']`})}return{type:"setter",code:variable}},mapper:function(node){var func=node.tokens[0];var fn=func.raw;var fnindex=func.index;func=analyze(func).code;var args=analyze(node.tokens.slice(1)).map(t=>t.code);var args=`[${args.join(", ")}]`;return{code:[func,args],fn:fn,fnindex:fnindex}},naked_mapper:function(node){var func=node.tokens[0];var fn=func.raw;var fnindex=func.index;func=analyze(func).code;var args="[]";return{code:[func,args],fn:fn,fnindex:fnindex}},starmapper:function(node){var func=node.tokens[0];func=analyze(func).code;var args=analyze(node.tokens.slice(1)).map(t=>t.code);var args=`[${args.join(", ")}]`;return{code:[func,args],type:"map"}},naked_star_mapper:function(node){var func=node.tokens[0];func=analyze(func).code;var args="[]";return{code:[func,args],type:"map"}},return_mapper:function(node){var func=node.tokens[0].raw;return{type:"return"}},filter:function(node){var arg=node.tokens[0].raw;var body=node.tokens[1];var block={name:"block",tokens:[body]};var func={name:"fundef",tokens:[{name:"symbol",raw:""},{name:"symbol",raw:arg},block]};funcode=analyze(func).code;return{code:funcode,type:"filter"}},wrapped_math:function(node){return analyze(node.tokens[0])},math:function(node){const ops={"*":"builtins.mul","^":"builtins.pow","/":"builtins.div","+":"builtins.add","-":"builtins.dec","%":"builtins.mod"};var left=analyze(node.tokens[0].tokens[0]);var op=ops[node.tokens[0].tokens[1].raw];var right=analyze(node.tokens[0].tokens[2]);return{code:`builtins.funcall([${left.code}], [${right.code}], ${op}, file, {index: ${node.index}, fn: '${op}'})`,vars:(left.vars||[]).concat(right.vars||[])}},decorated_fundef:function(node){var func=analyze(node.tokens.pop());var code=[];while(node.tokens.length){token=node.tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code.push(`builtins.decorate_function(${name}, [${args}], '${func.name}', ${func.overload}, scope)`)}code.unshift(func.code);code=code.join(";\n");return{code:code}},decorated_fundefif:function(node){var func=analyze(node.tokens.pop());var code=[];while(node.tokens.length){token=node.tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code.push(`builtins.decorate_function(${name}, [${args}], '${func.name}', ${func.overload}, scope)`)}code.unshift(func.code);code=code.join(";\n");return{code:code}},decorated_fundefof:function(node){var func=analyze(node.tokens.pop());var code=[];while(node.tokens.length){token=node.tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code.push(`builtins.decorate_function(${name}, [${args}], '${func.name}', ${func.overload}, scope)`)}code.unshift(func.code);code=code.join(";\n");return{code:code}},decorated_fundefifof:function(node){var func=analyze(node.tokens.pop());var code=[];while(node.tokens.length){token=node.tokens.pop().tokens;token.shift();var name=analyze(token.shift()).code;var args=analyze(token).map(t=>t.code);args=args.join(", ");code.push(`builtins.decorate_function(${name}, [${args}], '${func.name}', ${func.overload}, scope)`)}code.unshift(func.code);code=code.join(";\n");return{code:code}},typedef:function(node){var type_name=node.tokens[0].raw;node.name="fundef";node.tokens[0].raw="init";var block=node.tokens.pop();var type_setter={name:"flow",tokens:[{name:"string",raw:`'${type_name}'`},{name:"setter",tokens:[{name:"property_access",tokens:[{name:"possesive",raw:"my"},{name:"symbol",raw:"type"}]}]}]};block.tokens.push(type_setter);block.tokens.push({name:"symbol",raw:"self"});node.tokens.push({name:"symbol",raw:"self"});node.tokens.push(block);var func=analyze(node);var code=`scope['${type_name}'] = (function(scope) {\n        scope = Object.assign({}, scope);\n        var init = ${func.code};\n        return function (...args) {\n          return init(...args, {});\n        }\n      })(scope)`;return{code:code}},fundef:function(node){var block=node.tokens.pop().tokens;var implicit_return=make_return(block.pop());block.push(implicit_return);var block_vars=[];var block=analyze(block).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");var name=node.tokens.shift().raw;var args=node.tokens.map(t=>t.raw).join(", ");var arg_names=node.tokens.map(t=>`'${t.raw}'`).join(", ");if(name==""){return{code:`(function (scope) {\n            var func = builtins.lazy(async function(${args}) {\n              var scope = Object.assign({}, func.frozenscope);\n              var args_obj = {};\n              var _arguments = arguments;\n              [${arg_names}].forEach(function(arg, index) {\n                  scope[arg] = _arguments[index]\n              });\n              ${block}\n            }, true);\n            func.frozenscope = Object.assign({}, scope);\n            func.frozenscope['recall'] = func;\n            return func;\n          })(scope)`}}return{code:`builtins.define_function((function (scope) {\n          var func = builtins.lazy(async function(${args}) {\n            var scope = Object.assign({}, func.frozenscope);\n            var args_obj = {};\n            var _arguments = arguments;\n            [${arg_names}].forEach(function(arg, index) {\n                scope[arg] = _arguments[index]\n            });\n            ${block}\n          }, true);\n          func.frozenscope = Object.assign({}, scope);\n          func.frozenscope['${name}'] = func;\n          func.frozenscope['recall'] = func;\n          return func;\n        })(scope), '${name}', scope)`,name:name,overload:`'default'`}},fundefif:function(node){var block=node.tokens.pop().tokens;var _ifs=node.tokens.pop();if(_ifs.name=="symbol"){_ifs=[`'${_ifs.raw}'`]}else{_ifs=_ifs.tokens.map(t=>`'${t.raw}'`)}var implicit_return=make_return(block.pop());block.push(implicit_return);var block_vars=[];var block=analyze(block).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");var name=node.tokens.shift().raw;var args=node.tokens.map(t=>t.raw).join(", ");var arg_names=node.tokens.map(t=>`'${t.raw}'`).join(", ");return{code:`builtins.define_function((function (scope) {\n          var func = builtins.lazy(async function(${args}) {\n            var scope = Object.assign({}, func.frozenscope);\n            var args_obj = {};\n            var _arguments = arguments;\n            [${arg_names}].forEach(function(arg, index) {\n                scope[arg] = _arguments[index]\n            });\n            ${block}\n          }, true);\n          func.frozenscope = Object.assign({}, scope);\n          func.frozenscope['${name}'] = func;\n          func.frozenscope['self'] = func;\n          func.overload = [${_ifs}];\n          return func;\n        })(scope), '${name}', scope)`,name:name,overload:`[${_ifs}]`}},fundefof:function(node){var block=node.tokens.pop().tokens;var implicit_return=make_return(block.pop());block.push(implicit_return);var block_vars=[];var block=analyze(block).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");var name=node.tokens.shift().raw;var overload=node.tokens.pop().tokens[0].raw;var args=node.tokens.map(t=>t.raw).join(", ");var arg_names=[`'self'`,...node.tokens.map(t=>`'${t.raw}'`)].join(", ");return{code:`builtins.define_function((function (scope) {\n          var func = builtins.lazy(async function(${args}) {\n            var scope = Object.assign({}, func.frozenscope);\n            var args_obj = {};\n            var _arguments = arguments;\n            [${arg_names}].forEach(function(arg, index) {\n                scope[arg] = _arguments[index]\n            });\n            ${block}\n          }, true);\n          func.frozenscope = Object.assign({}, scope);\n          func.frozenscope['${name}'] = func;\n          func.frozenscope['self'] = func;\n          func.overload = ['${overload}'];\n          return func;\n        })(scope), '${name}', scope)`,name:name,overload:`['${overload}']`}},fundefifof:function(node){var block=node.tokens.pop().tokens;var implicit_return=make_return(block.pop());block.push(implicit_return);var block_vars=[];var block=analyze(block).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");var name=node.tokens.shift().raw;var _of=node.tokens.pop().tokens[0].raw;var _ifs=node.tokens.pop();if(_ifs.name=="symbol"){_ifs=[_ifs.raw]}else{_ifs=_ifs.tokens.map(t=>t.raw)}var overload=[_of,..._ifs].map(o=>`'${o}'`).join(", ");var args=node.tokens.map(t=>t.raw).join(", ");var arg_names=[`'self'`,...node.tokens.map(t=>`'${t.raw}'`)].join(", ");return{code:`builtins.define_function((function (scope) {\n          var func = builtins.lazy(async function(${args}) {\n            var scope = Object.assign({}, func.frozenscope);\n            var args_obj = {};\n            var _arguments = arguments;\n            [${arg_names}].forEach(function(arg, index) {\n                scope[arg] = _arguments[index]\n            });\n            ${block}\n          }, true);\n          func.frozenscope = Object.assign({}, scope);\n          func.frozenscope['${name}'] = func;\n          func.frozenscope['self'] = func;\n          func.overload = [${overload}];\n          return func;\n        })(scope), '${name}', scope)`,name:name,overload:`[${overload}]`}},inflowprocdef:function(node){node.tokens.unshift({name:"symbol",raw:""});node.name="procdef";var func_code=analyze(node).code;return{type:"inflowprocdef",code:func_code}},starinflowprocdef:function(node){node.tokens.unshift({name:"symbol",raw:""});node.name="procdef";var func_code=analyze(node).code;return{type:"starinflowprocdef",code:func_code}},procdef:function(node){var block=node.tokens.pop().tokens;var implicit_return=make_return(block.pop());block.push(implicit_return);var block_vars=[];var block=analyze(block).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");var name=node.tokens.shift().raw;var args=node.tokens.map(t=>t.raw).join(", ");var arg_names=node.tokens.map(t=>`'${t.raw}'`).join(", ");if(name==""){return{code:`function(${args}) {\n              var args_obj = {};\n              var _arguments = arguments;\n              [${arg_names}].forEach(function (arg, index) {\n                args_obj[arg] = _arguments[index]\n              })\n              scope = Object.assign(scope, args_obj);\n              ${block}\n            }`}}return{code:`scope['${name}'] = function(${args}) {\n            var args_obj = {};\n            var _arguments = arguments;\n            [${arg_names}].forEach(function (arg, index) {\n              args_obj[arg] = _arguments[index]\n            })\n            scope = Object.assign(scope, args_obj);\n            ${block}\n          }`}},empty_list:function(node){return{code:`new builtins.Generator(\n          (i, self) => self.data[i],\n          [],\n          self => self.data.length,\n        )`}},condmapper:function(node){var conditional=node.tokens[0];var tokens=conditional.tokens;var else_statement;if(tokens[tokens.length-1].name=="else_block"){else_statement=tokens.pop()}function transform(expr){if(expr.name=="halfcmp"){expr.tokens.unshift({name:"symbol",raw:"$in"});expr.name="cmpexpr"}else if(expr.name=="if_fun_call"){expr.name="mapper";expr={name:"flow",tokens:[{name:"symbol",raw:"$in"},expr]}}else if(expr.name=="symbol"){expr.name="naked_mapper";expr={name:"flow",tokens:[{name:"symbol",raw:"$in"},expr]}}else if(expr.name=="flow"){var left=expr.tokens[0];if(left.name=="if_fun_call"){expr.tokens[0].name="mapper"}else if(left.name=="symbol"){expr.tokens[0]={name:"naked_mapper",tokens:[expr.tokens[0]]}}else{}expr.tokens.unshift({name:"symbol",raw:"$in"})}else if(expr.name=="cmpexpr"){var left=expr.tokens[0];if(["symbol","if_fun_call","flow"].includes(left.name)){expr.tokens[0]=transform(left)}else{}}return expr}tokens=tokens.map(function(statement){statement.tokens[0]=transform(statement.tokens[0]);return statement});if(else_statement){tokens.push(else_statement)}var fun_def={name:"fundef",tokens:[{name:"symbol",raw:""},{name:"symbol",raw:"$in"},{name:"block",tokens:[{name:"conditional",tokens:tokens}]}]};var code=analyze(fun_def).code;return{code:`(${code})`,type:"condmapper"}},starcondmapper:function(node){node.name="condmapper";var result=analyze(node);result.type="starcondmapper";return result},conditional:function(node){var block_vars=[];var code=node.tokens.map(analyze).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(" ");return{code:code,vars:block_vars}},if_statement:function(node){var variables=[];var condition=analyze(node.tokens[0]);if(node.tokens[1].name!="block"){node.tokens[1]={name:"block",tokens:[node.tokens[1]]}}var block=node.tokens[1].tokens.map(analyze).map(function(t){if(t.vars){t.vars.forEach(v=>variables.push(v))}return t.code}).join(";\n");if(condition.variables){condition.variables.forEach(v=>variables.push(v))}return{code:`if (await builtins.funcall([${condition.code}], [], builtins.bool), file, {index: ${node.index}, fn: '<conditional>'}) {${block}}`,vars:variables}},elif_statement:function(node){node.name="if_statement";var result=analyze(node);result.code=`else ${result.code}`;return result},else_statement:function(node){if(node.tokens[0].name!="block"){node.tokens[0]={name:"block",tokens:[node.tokens[0]]}}block_vars=[];var block=analyze(node.tokens[0].tokens).map(function(t){if(t.vars){t.vars.forEach(v=>block_vars.push(v))}return t.code}).join(";\n");return{code:`else{${block}}`,vars:block_vars}}};function analyze(tree){if(tree.constructor===Array){var result=tree.map(function(node){var result=analyzers[node.name](node);result.index=result.index||node.index;return result})}else{var result=analyzers[tree.name](tree);result.index=result.index||tree.index}return result}tree=analyze(tree);var variables=[];tree.forEach(function(t){if(t.vars){t.vars.forEach(function(v){variables.push(v)})}});var code=tree.map(t=>t.code||t).join(";\n");var code=`module.exports = async function (scope, builtins, file) {\n    ${code};\n    return scope;\n  };`;return code}module.exports=analyzer},{"../common":2,"decimal.js":15,"unescape-js":20}],4:[function(require,module,exports){var{lazy:lazy,value:value,lazy_call:lazy_call}=require("../internals/lazy");var{Transform:Transform,AtSign:AtSign,Decimal:Decimal,Generator:Generator,Property:Property}=require("../internals/types");const{throw_error:throw_error,exception_handler:exception_handler}=require("../common");var builtins={};builtins.error=throw_error;builtins.lazy=lazy;builtins.lazy_call=lazy_call;builtins.value=value;builtins.Transform=Transform;builtins.AtSign=AtSign;builtins.Decimal=Decimal;builtins.Generator=Generator;builtins.Property=Property;function jsonReplacer(key,value){if(value.toNumber){return value.toNumber()}if(value.constructor==Array){return value.map(function(v,k){return jsonReplacer(k,v)})}return value}function jsonReviver(key,value){if(value.constructor==Number){return Decimal(value)}if(value.constructor==Array){return value.map(function(v,k){return jsonReviver(k,v)})}return value}var js_to_clio_type_map=function(type){switch(type){case String:return"str";case Object:return"obj";case Generator:return"gen";case Decimal:return"num";default:}};builtins.typeof=function(thing){return thing.type||js_to_clio_type_map(thing.constructor)||thing.constructor};var get_proper_function=function(args,funcs){var types=args.map(builtins.typeof);for(var i=0;i<funcs.length;i++){var func=funcs[i];if(!func.overload){return func}var sliced_types=types.slice(0,func.overload.length);if(sliced_types.every(e=>func.overload.includes(e))){return func}}};builtins.define_function=function(fn,fn_name,scope){if(scope[fn_name]){var overloadfn=scope[fn_name];var overloads=overloadfn.overloads}else{var overloadfn=async function(...args){var func=get_proper_function(args,overloadfn.overloads);return func(...args)};if(fn.is_lazy){overloadfn=lazy(overloadfn)}var overloads=[]}overloads.push(fn);overloadfn.overloads=overloads.sort(function(a,b){if(a.overload){a=a.overload.length}else{a=0}if(b.overload){b=b.overload.length}else{b=0}return a<b});scope[fn_name]=overloadfn;return overloadfn};builtins.decorate_function=function(decorator,args,fn_name,overload,scope){if(fn_name.constructor==Function){var overloadfn=async function(...args){var func=get_proper_function(args,overloadfn.overloads);return func(...args)};if(fn_name.is_lazy){overloadfn=lazy(overloadfn)}var overloads=[];overloads.push(fn_name);overloadfn.overloads=overloads;return decorator(overloadfn,overload,...args)}var overload_fn=scope[fn_name];var decorated_fn=decorator(overload_fn,overload,...args);scope[fn_name]=decorated_fn;return decorated_fn};builtins.cloud_call=async function(url,fn_name,args,kwargs){var data=JSON.stringify({fn_name:fn_name,args:args,kwargs:kwargs},jsonReplacer);var response=await fetch(`${url}/execute`,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/clio-cloud-call"},redirect:"follow",referrer:"no-referrer",body:data});response=JSON.parse(await response.text(),jsonReviver);if(response.stdout){console.log(response.stdout.replace(/\n$/,""))}return response.result};builtins.get_symbol=function(key,scope){if(scope.hasOwnProperty(key)){return scope[key]}if(builtins.hasOwnProperty(key)){return builtins[key]}return new builtins.Property(key)};builtins.funcall=async function(data,args,func,file,trace){var current_stack=[{file:file,trace:trace}];var func_call;if(func.constructor==Property){var prop=func.prop;func=function(data,...args){return data[prop](...args)}}if(!func.is_lazy){args=Promise.all(args).catch(e=>{exception_handler(e,{clio_stack:current_stack})});data=Promise.all(data).catch(e=>{exception_handler(e,{clio_stack:current_stack})});args=await value(args).catch(e=>{exception_handler(e,{clio_stack:current_stack})});data=await value(data).catch(e=>{exception_handler(e,{clio_stack:current_stack})})}if(!args.length){func_call=func(...data).catch(e=>{exception_handler(e,{clio_stack:current_stack})});if(func_call.constructor==builtins.lazy_call){func_call.clio_stack=current_stack}return await func_call}var AtSigned=false;args=args.map(function(arg){if(arg.constructor==Transform){AtSigned=true;if(!func.is_lazy){return value(arg.transform(data))}return arg.transform(data)}else if(arg.constructor==AtSign){AtSigned=true;return data[arg.index]}return arg});args=await Promise.all(args).catch(e=>{exception_handler(e,{clio_stack:current_stack})});if(AtSigned){func_call=func(...args).catch(e=>{exception_handler(e,{clio_stack:current_stack})});if(func_call.constructor==builtins.lazy_call){func_call.clio_stack=current_stack}return await func_call}func_call=func(...data,...args);if(func_call.constructor==Promise){func_call=await func_call.catch(e=>{exception_handler(e,{clio_stack:current_stack})})}if(func_call.constructor==builtins.lazy_call){func_call.clio_stack=current_stack}return func_call};builtins.map=async function(a,f,...args){if(!f.is_lazy){args=await Promise.all(args.map(value));a=await Promise.all(a.map(value))}data=a.shift();if(!args.length){if(!f.is_lazy){return await data.map(function(d){return f(d,...a)})}else{return await data.map(lazy(function(d){return f(d,...a)}))}}var fn=async function(d){var AtSigned=false;_args=args.map(async function(arg){if(arg.constructor==Transform){AtSigned=true;if(!f.is_lazy){return value(arg.transform([d,...a]))}return arg.transform([d,...a])}else if(arg.constructor==AtSign){AtSigned=true;return[d,...a][arg.index]}return arg});_args=await Promise.all(_args);if(AtSigned){return await f(..._args)}return await f(d,..._args)};if(f.is_lazy){fn=lazy(fn)}return await data.map(fn)};builtins.starmap=function(a,f,args){if(!args.length){return builtins.map(a,f)}return builtins.map(a,f,...args)};builtins.filter=function(data,func){if(func.constructor==Generator){var filter_data=func;func=function(n,i){return filter_data.get(i)}}if(data.constructor!==Array){return[data].filter(func)}return data.filter(func)};builtins.dec=lazy(function(a,b){if(a.constructor==builtins.Generator){return a.map(el=>builtins.dec(el,b))}return a.sub(b)});builtins.add=lazy(function(a,b){if(a.constructor==String||b.constructor==String){return a.toString()+b.toString()}if(a.constructor==builtins.Generator){return a.map(el=>builtins.add(el,b))}return a.add(b)});builtins.div=lazy(function(a,b){if(a.constructor==builtins.Generator){return a.map(el=>builtins.div(el,b))}return a.div(b)});builtins.mul=lazy(async function(a,b){if(a.constructor==builtins.Generator){return await a.map(el=>builtins.mul(el,b))}return a.mul(b)});builtins.mod=lazy(function(a,b){if(a.constructor==builtins.Generator){return a.map(el=>builtins.mod(el,b))}return a.mod(b)});builtins.pow=lazy(function(a,b){if(a.constructor==builtins.Generator){return a.map(el=>builtins.pow(el,b))}return a.pow(b)});builtins.bool=function(a){if(a.constructor==builtins.Decimal){return!a.eq(0)}return a};builtins.not=function(a){return!a};builtins.eq=function(a,b){if(a.eq){return a.eq(b)}return a==b};builtins.lt=function(a,b){return a.lt(b)};builtins.lte=function(a,b){return a.lte(b)};builtins.gt=function(a,b){return a.gt(b)};builtins.gte=function(a,b){return a.gte(b)};builtins.cat=lazy(function(){if(typeof arguments[0]=="string"){return[...arguments].join("")}});builtins.head=lazy(function(a){return a[0]});builtins.tail=lazy(function(a){return a.slice(1)});builtins.append=lazy(function(a,b){a.push(b);return a});builtins.length=lazy(function(a){return a.length});var chalk=require("chalk");var colormap={int:chalk.yellow,range:chalk.cyan};builtins.string=lazy(async function(thing,colorize){var type=await value(builtins.typeof(thing));var string;if(type=="gen"){if(thing.data.start){type="int";var start=thing.data.start;var end=thing.data.end;var step=thing.data.step;string=[start,end,step].join(colors.white(":"))}else{string=await Promise.all((await value(thing.map(i=>builtins.string(i,colorize)))).data.map(value));string=string.join(" ");string=`[${string}]`}}else{string=thing.toString()}if(colorize){string=(colormap[type]||colors.white)(string)}return string});builtins.print=async function(...args){var _args=await Promise.all(args.map(a=>builtins.string(a,true)).map(value));console.log(..._args);return args[0]};builtins.flat=lazy(function(a){var res=[];a.forEach(function(_a){_a.forEach(function(__a){res.push(__a)})});return res});builtins.take=lazy(function(list,n){});builtins.slice=lazy(async function(list,slicers,index){var slicer=slicers[index++];if(list.data.start){if(slicer.constructor==Decimal){if(slicer.toNumber()>=list.len()){throw new Error(`Index ${slicer.toString()} is bigger than array length.`)}list=list.get(slicer.toNumber())}else if(slicer.data.start){var step=slicer.data.step;var start=list.data.start.add(slicer.data.start);var end;if(slicer.data.end==Infinity){end=list.data.end}else{end=list.data.end.sub(slicer.data.end)}list=new Generator(list.getter,{start:start,end:end,step:step},list.length)}else{var indices=slicer.data.map(d=>d.toNumber());list=new Generator(list.getter,indices.map(i=>list.get(i)),list.length)}}else{if(slicer.constructor==Decimal){if(slicer.toNumber()>=list.len()){throw new Error(`Index ${slicer.toString()} is bigger than array length.`)}list=list.get(slicer.toNumber())}else if(slicer.data.start){list=new Generator(list.getter,list.data.filter(function(_,i){return slicer.data.start.lte(i)&&slicer.data.end.gt(i)&&new builtins.Decimal(i).sub(slicer.data.start).mod(slicer.data.step).eq(0)}),list.length)}else{var indices=slicer.data.map(d=>d.toNumber());list=new Generator(list.getter,list.data.filter((l,i)=>indices.includes(i)),list.length)}}if(index==slicers.length){return list}return list.map(l=>builtins.slice(l,slicers,index))});builtins.upper=lazy(function(a,b){if(b){return a.toLocaleUpperCase(b)}return a.toUpperCase()});builtins["sentence-case"]=lazy(function(a,b){if(b){return a[0].toLocaleUpperCase(b)+a.slice(1)}return a[0].toUpperCase(b)+a.slice(1)});builtins.eval=(expr=>expr);builtins.eager=function(oldoverload){var newoverload=async function(...args){var func=await get_proper_function(args,newoverload.overloads);return await value(await func(...args))};newoverload.overloads=oldoverload.overloads;return newoverload};module.exports=builtins},{"../common":2,"../internals/lazy":5,"../internals/types":6,chalk:9}],5:[function(require,module,exports){const{exception_handler:exception_handler}=require("../common");function memoize(fn){var cache=new Map;return async function(...args){args=await Promise.all(args);var hash=args.toString();var cached=cache.get(hash);if(cached!=undefined){return cached}var result=await fn(...args);cache.set(hash,result);return result}}function lazy(fn,do_memoize){if(do_memoize){fn=memoize(fn)}var func=function(...args){return new lazy_call(fn,...args)};func.is_lazy=true;return func}class lazy_call{constructor(fn,...args){this.fn=fn;this.args=args}async call(){var self=this;this.args=await Promise.all(this.args).catch(e=>exception_handler(e,self));this.args=await value(this.args).catch(e=>exception_handler(e,self));var result=await this.fn(...this.args).catch(e=>exception_handler(e,self));if(result.constructor==lazy_call){if(result.clio_stack){if(this.clio_stack){result.clio_stack=[...result.clio_stack,...this.clio_stack]}}else{result.clio_stack=this.clio_stack}}return result}async map(fn){var self=this;if(!fn.is_lazy){return(await value(self).catch(e=>{throw e})).map(fn)}else{return lazy(async function(){return(await value(self).catch(e=>{throw e})).map(fn)})}}}async function process_args(lazy){var needs_processing=[];if(lazy.constructor==lazy_call){for(var i=0;i<lazy.args.length;i++){var arg=lazy.args[i];if(arg.constructor==Array){arg=await Promise.all(arg);arg=await value(arg);lazy.args[i]=arg}if(arg.constructor==lazy_call){var result=await arg.call().catch(e=>{throw e});lazy.args[i]=result;if(result.constructor==lazy_call){needs_processing.push(result)}}}}return needs_processing}async function value_helper(lazy){var needs_processing=[lazy];while(needs_processing.length){var current=needs_processing.pop();current.args=await Promise.all(current.args);var even_more_to_process=process_args(current);while(even_more_to_process.length){needs_processing.push(even_more_to_process.pop())}}var parent=null;var index;var level=lazy;while(true){var all_non_lazy=true;for(var i=0;i<level.args.length;i++){if(level.args[i].constructor==lazy_call){parent=level;index=i;level=level.args[i];all_non_lazy=false;break}}if(all_non_lazy){var result=await level.call().catch(e=>{throw e});if(parent==null){return await value(result)}parent.args[index]=result;level=lazy;parent=null}}}function has_lazy_args(lazy){for(var i=0;i<lazy.args.length;i++){if(lazy.args[i].constructor==lazy_call){return i}}return false}async function value_of(lazy){var parent=null;var current=lazy;var index=0;var i=0;while(true){if(current==undefined){return current}if(current.constructor!=lazy_call){return current}current.args=await Promise.all(current.args);var lazy_index=has_lazy_args(current);if(lazy_index!==false){parent=current;current=current.args[lazy_index];index=lazy_index}else{var result=await value_helper(current);if(parent!=null){parent.args[index]=result;current=lazy;parent=null;index=0}else{current=result}}}}async function value(lazy){if(lazy==undefined){return lazy}if(lazy.constructor==Array){return await Promise.all(lazy.map(value))}var result=await value_of(lazy);if(result==undefined){return result}if(result.constructor==Array){return await Promise.all(result.map(value))}if(result.constructor==lazy_call){return await value(result)}if(result.is_lazy){return await value(result.call().catch(e=>{throw e}))}return result}exports.lazy=lazy;exports.lazy_call=lazy_call;exports.value=value},{"../common":2}],6:[function(require,module,exports){const{lazy_call:lazy_call,value:value,lazy:lazy}=require("./lazy");var Decimal=require("decimal.js");class AtSign{constructor(index){this.index=index}}class Property{constructor(prop){this.prop=prop}}class Transform{constructor(func,index,star){this.func=func;this.star=star;this.index=index}transform(data){data=data[this.index];if(this.star){return data.map(this.func)}return this.func(data)}}class LazyRange{constructor(start,end,step,functor){this.start=start;this.end=end;this.step=step;this.functor=functor||this.default_functor}async get(index){var val=await this.functor(index,this);return val}length(){return this.end.sub(this.start).div(this.step).floor().abs().add(1)}default_functor(index,obj){return obj.start.add(obj.step.mul(index))}async map(fn){if(!fn.is_lazy){var result=[];for(var i=0;i<this.length();i++){result.push(await fn(await value(await this.get(i))))}}else{var functor=this.functor;var result=new LazyRange(this.start,this.end,this.step,function(index,obj){return fn(functor(index,obj))})}return result}}class Generator{constructor(getter,data,length){this.getter=getter;this.data=data;this.length=length}get(i){return this.getter(i,this)}len(){return this.length.constructor==Function?this.length(this):this.length}async map(func){if(!func.is_lazy){var result=[];for(var i=0;i<this.len();i++){result.push(await func(await value(this.get(i))))}return new Generator((i,self)=>self.data[i],result,self=>self.data.length)}else{var _this=this;return lazy(async function(){var result=[];for(var i=0;i<_this.len();i++){result.push(await func(await value(_this.get(i))))}return new Generator((i,self)=>self.data[i],result,self=>self.data.length)})()}}slice(slicers){return this.slicer(this,slicers)}}exports.Generator=Generator;exports.Property=Property;exports.AtSign=AtSign;exports.Transform=Transform;exports.Decimal=Decimal},{"./lazy":5,"decimal.js":15}],7:[function(require,module,exports){const patterns=require("../syntax/lexing");const throw_error=require("../common").throw_error;function lexer(string){var tokens=[];var pattern,match,imatch,matched,_i,raw;var i=0;var indents=[0];while(i<string.length){matched=false;for(var name in patterns){if(patterns.hasOwnProperty(name)){pattern=patterns[name];match=string.slice(i).match(pattern);if(match!=null){raw=match[0];if(name=="_n"){raw="\\n"}if(name!="emptyline"&&name!="comment"){tokens.push({name:name,index:i,raw:raw})}else if(name=="emptyline"){var indent_after=string.slice(i+raw.length).match(patterns._);if(indent_after==null){indent_after=0}else{indent_after=indent_after[0].length}if(indents[indents.length-1]>indent_after){var dedents_pushed=0;while(indents[indents.length-1]>indent_after){dedents_pushed+=1;tokens.push({name:"_n",index:i+1,raw:"\\n"});tokens.push({name:"dedent",index:i+1,raw:"-$"});indents.pop()}}else{tokens.push({name:"_n",index:i+1,raw:"\\n"})}}if(name=="_n"){imatch=string.slice(i+match[0].length).match(patterns._);_i=imatch?imatch[0].length:0;if(indents[indents.length-1]<_i){if(tokens[tokens.length-2].name=="colon"){tokens.push({name:"indent",index:i+1,raw:"+$"});indents.push(_i)}}else if(indents[indents.length-1]>_i){var dedents_pushed=0;while(indents[indents.length-1]>_i){dedents_pushed+=1;if(dedents_pushed>1){tokens.push({name:"_n",index:i+1,raw:"\\n"})}tokens.push({name:"dedent",index:i+1,raw:"-$"});indents.pop()}}tokens.push({name:"^",index:i+1,raw:"^"})}i+=match[0].length;matched=true;break}}}if(!matched){throw_error(string,`Lexing error`,i);return[false,tokens]}}tokens.push({name:"eof",index:string.length,raw:"eof"});return[true,tokens]}module.exports=lexer},{"../common":2,"../syntax/lexing":23}],8:[function(require,module,exports){"use strict";const colorConvert=require("color-convert");const wrapAnsi16=(fn,offset)=>(function(){const code=fn.apply(colorConvert,arguments);return`[${code+offset}m`});const wrapAnsi256=(fn,offset)=>(function(){const code=fn.apply(colorConvert,arguments);return`[${38+offset};5;${code}m`});const wrapAnsi16m=(fn,offset)=>(function(){const rgb=fn.apply(colorConvert,arguments);return`[${38+offset};2;${rgb[0]};${rgb[1]};${rgb[2]}m`});function assembleStyles(){const codes=new Map;const styles={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};styles.color.grey=styles.color.gray;for(const groupName of Object.keys(styles)){const group=styles[groupName];for(const styleName of Object.keys(group)){const style=group[styleName];styles[styleName]={open:`[${style[0]}m`,close:`[${style[1]}m`};group[styleName]=styles[styleName];codes.set(style[0],style[1])}Object.defineProperty(styles,groupName,{value:group,enumerable:false});Object.defineProperty(styles,"codes",{value:codes,enumerable:false})}const ansi2ansi=n=>n;const rgb2rgb=(r,g,b)=>[r,g,b];styles.color.close="[39m";styles.bgColor.close="[49m";styles.color.ansi={ansi:wrapAnsi16(ansi2ansi,0)};styles.color.ansi256={ansi256:wrapAnsi256(ansi2ansi,0)};styles.color.ansi16m={rgb:wrapAnsi16m(rgb2rgb,0)};styles.bgColor.ansi={ansi:wrapAnsi16(ansi2ansi,10)};styles.bgColor.ansi256={ansi256:wrapAnsi256(ansi2ansi,10)};styles.bgColor.ansi16m={rgb:wrapAnsi16m(rgb2rgb,10)};for(let key of Object.keys(colorConvert)){if(typeof colorConvert[key]!=="object"){continue}const suite=colorConvert[key];if(key==="ansi16"){key="ansi"}if("ansi16"in suite){styles.color.ansi[key]=wrapAnsi16(suite.ansi16,0);styles.bgColor.ansi[key]=wrapAnsi16(suite.ansi16,10)}if("ansi256"in suite){styles.color.ansi256[key]=wrapAnsi256(suite.ansi256,0);styles.bgColor.ansi256[key]=wrapAnsi256(suite.ansi256,10)}if("rgb"in suite){styles.color.ansi16m[key]=wrapAnsi16m(suite.rgb,0);styles.bgColor.ansi16m[key]=wrapAnsi16m(suite.rgb,10)}}return styles}Object.defineProperty(module,"exports",{enumerable:true,get:assembleStyles})},{"color-convert":12}],9:[function(require,module,exports){(function(process){"use strict";const escapeStringRegexp=require("escape-string-regexp");const ansiStyles=require("ansi-styles");const stdoutColor=require("supports-color").stdout;const template=require("./templates.js");const isSimpleWindowsTerm=process.platform==="win32"&&!(process.env.TERM||"").toLowerCase().startsWith("xterm");const levelMapping=["ansi","ansi","ansi256","ansi16m"];const skipModels=new Set(["gray"]);const styles=Object.create(null);function applyOptions(obj,options){options=options||{};const scLevel=stdoutColor?stdoutColor.level:0;obj.level=options.level===undefined?scLevel:options.level;obj.enabled="enabled"in options?options.enabled:obj.level>0}function Chalk(options){if(!this||!(this instanceof Chalk)||this.template){const chalk={};applyOptions(chalk,options);chalk.template=function(){const args=[].slice.call(arguments);return chalkTag.apply(null,[chalk.template].concat(args))};Object.setPrototypeOf(chalk,Chalk.prototype);Object.setPrototypeOf(chalk.template,chalk);chalk.template.constructor=Chalk;return chalk.template}applyOptions(this,options)}if(isSimpleWindowsTerm){ansiStyles.blue.open="[94m"}for(const key of Object.keys(ansiStyles)){ansiStyles[key].closeRe=new RegExp(escapeStringRegexp(ansiStyles[key].close),"g");styles[key]={get(){const codes=ansiStyles[key];return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,key)}}}styles.visible={get(){return build.call(this,this._styles||[],true,"visible")}};ansiStyles.color.closeRe=new RegExp(escapeStringRegexp(ansiStyles.color.close),"g");for(const model of Object.keys(ansiStyles.color.ansi)){if(skipModels.has(model)){continue}styles[model]={get(){const level=this.level;return function(){const open=ansiStyles.color[levelMapping[level]][model].apply(null,arguments);const codes={open:open,close:ansiStyles.color.close,closeRe:ansiStyles.color.closeRe};return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,model)}}}}ansiStyles.bgColor.closeRe=new RegExp(escapeStringRegexp(ansiStyles.bgColor.close),"g");for(const model of Object.keys(ansiStyles.bgColor.ansi)){if(skipModels.has(model)){continue}const bgModel="bg"+model[0].toUpperCase()+model.slice(1);styles[bgModel]={get(){const level=this.level;return function(){const open=ansiStyles.bgColor[levelMapping[level]][model].apply(null,arguments);const codes={open:open,close:ansiStyles.bgColor.close,closeRe:ansiStyles.bgColor.closeRe};return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,model)}}}}const proto=Object.defineProperties(()=>{},styles);function build(_styles,_empty,key){const builder=function(){return applyStyle.apply(builder,arguments)};builder._styles=_styles;builder._empty=_empty;const self=this;Object.defineProperty(builder,"level",{enumerable:true,get(){return self.level},set(level){self.level=level}});Object.defineProperty(builder,"enabled",{enumerable:true,get(){return self.enabled},set(enabled){self.enabled=enabled}});builder.hasGrey=this.hasGrey||key==="gray"||key==="grey";builder.__proto__=proto;return builder}function applyStyle(){const args=arguments;const argsLen=args.length;let str=String(arguments[0]);if(argsLen===0){return""}if(argsLen>1){for(let a=1;a<argsLen;a++){str+=" "+args[a]}}if(!this.enabled||this.level<=0||!str){return this._empty?"":str}const originalDim=ansiStyles.dim.open;if(isSimpleWindowsTerm&&this.hasGrey){ansiStyles.dim.open=""}for(const code of this._styles.slice().reverse()){str=code.open+str.replace(code.closeRe,code.open)+code.close;str=str.replace(/\r?\n/g,`${code.close}$&${code.open}`)}ansiStyles.dim.open=originalDim;return str}function chalkTag(chalk,strings){if(!Array.isArray(strings)){return[].slice.call(arguments,1).join(" ")}const args=[].slice.call(arguments,2);const parts=[strings.raw[0]];for(let i=1;i<strings.length;i++){parts.push(String(args[i-1]).replace(/[{}\\]/g,"\\$&"));parts.push(String(strings.raw[i]))}return template(chalk,parts.join(""))}Object.defineProperties(Chalk.prototype,styles);module.exports=Chalk();module.exports.supportsColor=stdoutColor;module.exports.default=module.exports}).call(this,require("_process"))},{"./templates.js":10,_process:25,"ansi-styles":8,"escape-string-regexp":16,"supports-color":18}],10:[function(require,module,exports){"use strict";const TEMPLATE_REGEX=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi;const STYLE_REGEX=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g;const STRING_REGEX=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/;const ESCAPE_REGEX=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi;const ESCAPES=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function unescape(c){if(c[0]==="u"&&c.length===5||c[0]==="x"&&c.length===3){return String.fromCharCode(parseInt(c.slice(1),16))}return ESCAPES.get(c)||c}function parseArguments(name,args){const results=[];const chunks=args.trim().split(/\s*,\s*/g);let matches;for(const chunk of chunks){if(!isNaN(chunk)){results.push(Number(chunk))}else if(matches=chunk.match(STRING_REGEX)){results.push(matches[2].replace(ESCAPE_REGEX,(m,escape,chr)=>escape?unescape(escape):chr))}else{throw new Error(`Invalid Chalk template style argument: ${chunk} (in style '${name}')`)}}return results}function parseStyle(style){STYLE_REGEX.lastIndex=0;const results=[];let matches;while((matches=STYLE_REGEX.exec(style))!==null){const name=matches[1];if(matches[2]){const args=parseArguments(name,matches[2]);results.push([name].concat(args))}else{results.push([name])}}return results}function buildStyle(chalk,styles){const enabled={};for(const layer of styles){for(const style of layer.styles){enabled[style[0]]=layer.inverse?null:style.slice(1)}}let current=chalk;for(const styleName of Object.keys(enabled)){if(Array.isArray(enabled[styleName])){if(!(styleName in current)){throw new Error(`Unknown Chalk style: ${styleName}`)}if(enabled[styleName].length>0){current=current[styleName].apply(current,enabled[styleName])}else{current=current[styleName]}}}return current}module.exports=((chalk,tmp)=>{const styles=[];const chunks=[];let chunk=[];tmp.replace(TEMPLATE_REGEX,(m,escapeChar,inverse,style,close,chr)=>{if(escapeChar){chunk.push(unescape(escapeChar))}else if(style){const str=chunk.join("");chunk=[];chunks.push(styles.length===0?str:buildStyle(chalk,styles)(str));styles.push({inverse:inverse,styles:parseStyle(style)})}else if(close){if(styles.length===0){throw new Error("Found extraneous } in Chalk template literal")}chunks.push(buildStyle(chalk,styles)(chunk.join("")));chunk=[];styles.pop()}else{chunk.push(chr)}});chunks.push(chunk.join(""));if(styles.length>0){const errMsg=`Chalk template literal is missing ${styles.length} closing bracket${styles.length===1?"":"s"} (\`}\`)`;throw new Error(errMsg)}return chunks.join("")})},{}],11:[function(require,module,exports){var cssKeywords=require("color-name");var reverseKeywords={};for(var key in cssKeywords){if(cssKeywords.hasOwnProperty(key)){reverseKeywords[cssKeywords[key]]=key}}var convert=module.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var model in convert){if(convert.hasOwnProperty(model)){if(!("channels"in convert[model])){throw new Error("missing channels property: "+model)}if(!("labels"in convert[model])){throw new Error("missing channel labels property: "+model)}if(convert[model].labels.length!==convert[model].channels){throw new Error("channel and label counts mismatch: "+model)}var channels=convert[model].channels;var labels=convert[model].labels;delete convert[model].channels;delete convert[model].labels;Object.defineProperty(convert[model],"channels",{value:channels});Object.defineProperty(convert[model],"labels",{value:labels})}}convert.rgb.hsl=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var min=Math.min(r,g,b);var max=Math.max(r,g,b);var delta=max-min;var h;var s;var l;if(max===min){h=0}else if(r===max){h=(g-b)/delta}else if(g===max){h=2+(b-r)/delta}else if(b===max){h=4+(r-g)/delta}h=Math.min(h*60,360);if(h<0){h+=360}l=(min+max)/2;if(max===min){s=0}else if(l<=.5){s=delta/(max+min)}else{s=delta/(2-max-min)}return[h,s*100,l*100]};convert.rgb.hsv=function(rgb){var rdif;var gdif;var bdif;var h;var s;var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var v=Math.max(r,g,b);var diff=v-Math.min(r,g,b);var diffc=function(c){return(v-c)/6/diff+1/2};if(diff===0){h=s=0}else{s=diff/v;rdif=diffc(r);gdif=diffc(g);bdif=diffc(b);if(r===v){h=bdif-gdif}else if(g===v){h=1/3+rdif-bdif}else if(b===v){h=2/3+gdif-rdif}if(h<0){h+=1}else if(h>1){h-=1}}return[h*360,s*100,v*100]};convert.rgb.hwb=function(rgb){var r=rgb[0];var g=rgb[1];var b=rgb[2];var h=convert.rgb.hsl(rgb)[0];var w=1/255*Math.min(r,Math.min(g,b));b=1-1/255*Math.max(r,Math.max(g,b));return[h,w*100,b*100]};convert.rgb.cmyk=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var c;var m;var y;var k;k=Math.min(1-r,1-g,1-b);c=(1-r-k)/(1-k)||0;m=(1-g-k)/(1-k)||0;y=(1-b-k)/(1-k)||0;return[c*100,m*100,y*100,k*100]};function comparativeDistance(x,y){return Math.pow(x[0]-y[0],2)+Math.pow(x[1]-y[1],2)+Math.pow(x[2]-y[2],2)}convert.rgb.keyword=function(rgb){var reversed=reverseKeywords[rgb];if(reversed){return reversed}var currentClosestDistance=Infinity;var currentClosestKeyword;for(var keyword in cssKeywords){if(cssKeywords.hasOwnProperty(keyword)){var value=cssKeywords[keyword];var distance=comparativeDistance(rgb,value);if(distance<currentClosestDistance){currentClosestDistance=distance;currentClosestKeyword=keyword}}}return currentClosestKeyword};convert.keyword.rgb=function(keyword){return cssKeywords[keyword]};convert.rgb.xyz=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92;b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92;var x=r*.4124+g*.3576+b*.1805;var y=r*.2126+g*.7152+b*.0722;var z=r*.0193+g*.1192+b*.9505;return[x*100,y*100,z*100]};convert.rgb.lab=function(rgb){var xyz=convert.rgb.xyz(rgb);var x=xyz[0];var y=xyz[1];var z=xyz[2];var l;var a;var b;x/=95.047;y/=100;z/=108.883;x=x>.008856?Math.pow(x,1/3):7.787*x+16/116;y=y>.008856?Math.pow(y,1/3):7.787*y+16/116;z=z>.008856?Math.pow(z,1/3):7.787*z+16/116;l=116*y-16;a=500*(x-y);b=200*(y-z);return[l,a,b]};convert.hsl.rgb=function(hsl){var h=hsl[0]/360;var s=hsl[1]/100;var l=hsl[2]/100;var t1;var t2;var t3;var rgb;var val;if(s===0){val=l*255;return[val,val,val]}if(l<.5){t2=l*(1+s)}else{t2=l+s-l*s}t1=2*l-t2;rgb=[0,0,0];for(var i=0;i<3;i++){t3=h+1/3*-(i-1);if(t3<0){t3++}if(t3>1){t3--}if(6*t3<1){val=t1+(t2-t1)*6*t3}else if(2*t3<1){val=t2}else if(3*t3<2){val=t1+(t2-t1)*(2/3-t3)*6}else{val=t1}rgb[i]=val*255}return rgb};convert.hsl.hsv=function(hsl){var h=hsl[0];var s=hsl[1]/100;var l=hsl[2]/100;var smin=s;var lmin=Math.max(l,.01);var sv;var v;l*=2;s*=l<=1?l:2-l;smin*=lmin<=1?lmin:2-lmin;v=(l+s)/2;sv=l===0?2*smin/(lmin+smin):2*s/(l+s);return[h,sv*100,v*100]};convert.hsv.rgb=function(hsv){var h=hsv[0]/60;var s=hsv[1]/100;var v=hsv[2]/100;var hi=Math.floor(h)%6;var f=h-Math.floor(h);var p=255*v*(1-s);var q=255*v*(1-s*f);var t=255*v*(1-s*(1-f));v*=255;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}};convert.hsv.hsl=function(hsv){var h=hsv[0];var s=hsv[1]/100;var v=hsv[2]/100;var vmin=Math.max(v,.01);var lmin;var sl;var l;l=(2-s)*v;lmin=(2-s)*vmin;sl=s*vmin;sl/=lmin<=1?lmin:2-lmin;sl=sl||0;l/=2;return[h,sl*100,l*100]};convert.hwb.rgb=function(hwb){var h=hwb[0]/360;var wh=hwb[1]/100;var bl=hwb[2]/100;var ratio=wh+bl;var i;var v;var f;var n;if(ratio>1){wh/=ratio;bl/=ratio}i=Math.floor(6*h);v=1-bl;f=6*h-i;if((i&1)!==0){f=1-f}n=wh+f*(v-wh);var r;var g;var b;switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break}return[r*255,g*255,b*255]};convert.cmyk.rgb=function(cmyk){var c=cmyk[0]/100;var m=cmyk[1]/100;var y=cmyk[2]/100;var k=cmyk[3]/100;var r;var g;var b;r=1-Math.min(1,c*(1-k)+k);g=1-Math.min(1,m*(1-k)+k);b=1-Math.min(1,y*(1-k)+k);return[r*255,g*255,b*255]};convert.xyz.rgb=function(xyz){var x=xyz[0]/100;var y=xyz[1]/100;var z=xyz[2]/100;var r;var g;var b;r=x*3.2406+y*-1.5372+z*-.4986;g=x*-.9689+y*1.8758+z*.0415;b=x*.0557+y*-.204+z*1.057;r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*12.92;g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g*12.92;b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:b*12.92;r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return[r*255,g*255,b*255]};convert.xyz.lab=function(xyz){var x=xyz[0];var y=xyz[1];var z=xyz[2];var l;var a;var b;x/=95.047;y/=100;z/=108.883;x=x>.008856?Math.pow(x,1/3):7.787*x+16/116;y=y>.008856?Math.pow(y,1/3):7.787*y+16/116;z=z>.008856?Math.pow(z,1/3):7.787*z+16/116;l=116*y-16;a=500*(x-y);b=200*(y-z);return[l,a,b]};convert.lab.xyz=function(lab){var l=lab[0];var a=lab[1];var b=lab[2];var x;var y;var z;y=(l+16)/116;x=a/500+y;z=y-b/200;var y2=Math.pow(y,3);var x2=Math.pow(x,3);var z2=Math.pow(z,3);y=y2>.008856?y2:(y-16/116)/7.787;x=x2>.008856?x2:(x-16/116)/7.787;z=z2>.008856?z2:(z-16/116)/7.787;x*=95.047;y*=100;z*=108.883;return[x,y,z]};convert.lab.lch=function(lab){var l=lab[0];var a=lab[1];var b=lab[2];var hr;var h;var c;hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360}c=Math.sqrt(a*a+b*b);return[l,c,h]};convert.lch.lab=function(lch){var l=lch[0];var c=lch[1];var h=lch[2];var a;var b;var hr;hr=h/360*2*Math.PI;a=c*Math.cos(hr);b=c*Math.sin(hr);return[l,a,b]};convert.rgb.ansi16=function(args){var r=args[0];var g=args[1];var b=args[2];var value=1 in arguments?arguments[1]:convert.rgb.hsv(args)[2];value=Math.round(value/50);if(value===0){return 30}var ansi=30+(Math.round(b/255)<<2|Math.round(g/255)<<1|Math.round(r/255));if(value===2){ansi+=60}return ansi};convert.hsv.ansi16=function(args){return convert.rgb.ansi16(convert.hsv.rgb(args),args[2])};convert.rgb.ansi256=function(args){var r=args[0];var g=args[1];var b=args[2];if(r===g&&g===b){if(r<8){return 16}if(r>248){return 231}return Math.round((r-8)/247*24)+232}var ansi=16+36*Math.round(r/255*5)+6*Math.round(g/255*5)+Math.round(b/255*5);return ansi};convert.ansi16.rgb=function(args){var color=args%10;if(color===0||color===7){if(args>50){color+=3.5}color=color/10.5*255;return[color,color,color]}var mult=(~~(args>50)+1)*.5;var r=(color&1)*mult*255;var g=(color>>1&1)*mult*255;var b=(color>>2&1)*mult*255;return[r,g,b]};convert.ansi256.rgb=function(args){if(args>=232){var c=(args-232)*10+8;return[c,c,c]}args-=16;var rem;var r=Math.floor(args/36)/5*255;var g=Math.floor((rem=args%36)/6)/5*255;var b=rem%6/5*255;return[r,g,b]};convert.rgb.hex=function(args){var integer=((Math.round(args[0])&255)<<16)+((Math.round(args[1])&255)<<8)+(Math.round(args[2])&255);var string=integer.toString(16).toUpperCase();return"000000".substring(string.length)+string};convert.hex.rgb=function(args){var match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match){return[0,0,0]}var colorString=match[0];if(match[0].length===3){colorString=colorString.split("").map(function(char){return char+char}).join("")}var integer=parseInt(colorString,16);var r=integer>>16&255;var g=integer>>8&255;var b=integer&255;return[r,g,b]};convert.rgb.hcg=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var max=Math.max(Math.max(r,g),b);var min=Math.min(Math.min(r,g),b);var chroma=max-min;var grayscale;var hue;if(chroma<1){grayscale=min/(1-chroma)}else{grayscale=0}if(chroma<=0){hue=0}else if(max===r){hue=(g-b)/chroma%6}else if(max===g){hue=2+(b-r)/chroma}else{hue=4+(r-g)/chroma+4}hue/=6;hue%=1;return[hue*360,chroma*100,grayscale*100]};convert.hsl.hcg=function(hsl){var s=hsl[1]/100;var l=hsl[2]/100;var c=1;var f=0;if(l<.5){c=2*s*l}else{c=2*s*(1-l)}if(c<1){f=(l-.5*c)/(1-c)}return[hsl[0],c*100,f*100]};convert.hsv.hcg=function(hsv){var s=hsv[1]/100;var v=hsv[2]/100;var c=s*v;var f=0;if(c<1){f=(v-c)/(1-c)}return[hsv[0],c*100,f*100]};convert.hcg.rgb=function(hcg){var h=hcg[0]/360;var c=hcg[1]/100;var g=hcg[2]/100;if(c===0){return[g*255,g*255,g*255]}var pure=[0,0,0];var hi=h%1*6;var v=hi%1;var w=1-v;var mg=0;switch(Math.floor(hi)){case 0:pure[0]=1;pure[1]=v;pure[2]=0;break;case 1:pure[0]=w;pure[1]=1;pure[2]=0;break;case 2:pure[0]=0;pure[1]=1;pure[2]=v;break;case 3:pure[0]=0;pure[1]=w;pure[2]=1;break;case 4:pure[0]=v;pure[1]=0;pure[2]=1;break;default:pure[0]=1;pure[1]=0;pure[2]=w}mg=(1-c)*g;return[(c*pure[0]+mg)*255,(c*pure[1]+mg)*255,(c*pure[2]+mg)*255]};convert.hcg.hsv=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var v=c+g*(1-c);var f=0;if(v>0){f=c/v}return[hcg[0],f*100,v*100]};convert.hcg.hsl=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var l=g*(1-c)+.5*c;var s=0;if(l>0&&l<.5){s=c/(2*l)}else if(l>=.5&&l<1){s=c/(2*(1-l))}return[hcg[0],s*100,l*100]};convert.hcg.hwb=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var v=c+g*(1-c);return[hcg[0],(v-c)*100,(1-v)*100]};convert.hwb.hcg=function(hwb){var w=hwb[1]/100;var b=hwb[2]/100;var v=1-b;var c=v-w;var g=0;if(c<1){g=(v-c)/(1-c)}return[hwb[0],c*100,g*100]};convert.apple.rgb=function(apple){return[apple[0]/65535*255,apple[1]/65535*255,apple[2]/65535*255]};convert.rgb.apple=function(rgb){return[rgb[0]/255*65535,rgb[1]/255*65535,rgb[2]/255*65535]};convert.gray.rgb=function(args){return[args[0]/100*255,args[0]/100*255,args[0]/100*255]};convert.gray.hsl=convert.gray.hsv=function(args){return[0,0,args[0]]};convert.gray.hwb=function(gray){return[0,100,gray[0]]};convert.gray.cmyk=function(gray){return[0,0,0,gray[0]]};convert.gray.lab=function(gray){return[gray[0],0,0]};convert.gray.hex=function(gray){var val=Math.round(gray[0]/100*255)&255;var integer=(val<<16)+(val<<8)+val;var string=integer.toString(16).toUpperCase();return"000000".substring(string.length)+string};convert.rgb.gray=function(rgb){var val=(rgb[0]+rgb[1]+rgb[2])/3;return[val/255*100]}},{"color-name":14}],12:[function(require,module,exports){var conversions=require("./conversions");var route=require("./route");var convert={};var models=Object.keys(conversions);function wrapRaw(fn){var wrappedFn=function(args){if(args===undefined||args===null){return args}if(arguments.length>1){args=Array.prototype.slice.call(arguments)}return fn(args)};if("conversion"in fn){wrappedFn.conversion=fn.conversion}return wrappedFn}function wrapRounded(fn){var wrappedFn=function(args){if(args===undefined||args===null){return args}if(arguments.length>1){args=Array.prototype.slice.call(arguments)}var result=fn(args);if(typeof result==="object"){for(var len=result.length,i=0;i<len;i++){result[i]=Math.round(result[i])}}return result};if("conversion"in fn){wrappedFn.conversion=fn.conversion}return wrappedFn}models.forEach(function(fromModel){convert[fromModel]={};Object.defineProperty(convert[fromModel],"channels",{value:conversions[fromModel].channels});Object.defineProperty(convert[fromModel],"labels",{value:conversions[fromModel].labels});var routes=route(fromModel);var routeModels=Object.keys(routes);routeModels.forEach(function(toModel){var fn=routes[toModel];convert[fromModel][toModel]=wrapRounded(fn);convert[fromModel][toModel].raw=wrapRaw(fn)})});module.exports=convert},{"./conversions":11,"./route":13}],13:[function(require,module,exports){var conversions=require("./conversions");function buildGraph(){var graph={};var models=Object.keys(conversions);for(var len=models.length,i=0;i<len;i++){graph[models[i]]={distance:-1,parent:null}}return graph}function deriveBFS(fromModel){var graph=buildGraph();var queue=[fromModel];graph[fromModel].distance=0;while(queue.length){var current=queue.pop();var adjacents=Object.keys(conversions[current]);for(var len=adjacents.length,i=0;i<len;i++){var adjacent=adjacents[i];var node=graph[adjacent];if(node.distance===-1){node.distance=graph[current].distance+1;node.parent=current;queue.unshift(adjacent)}}}return graph}function link(from,to){return function(args){return to(from(args))}}function wrapConversion(toModel,graph){var path=[graph[toModel].parent,toModel];var fn=conversions[graph[toModel].parent][toModel];var cur=graph[toModel].parent;while(graph[cur].parent){path.unshift(graph[cur].parent);fn=link(conversions[graph[cur].parent][cur],fn);cur=graph[cur].parent}fn.conversion=path;return fn}module.exports=function(fromModel){var graph=deriveBFS(fromModel);var conversion={};var models=Object.keys(graph);for(var len=models.length,i=0;i<len;i++){var toModel=models[i];var node=graph[toModel];if(node.parent===null){continue}conversion[toModel]=wrapConversion(toModel,graph)}return conversion}},{"./conversions":11}],14:[function(require,module,exports){"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],15:[function(require,module,exports){(function(globalScope){"use strict";var EXP_LIMIT=9e15,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-EXP_LIMIT,maxE:EXP_LIMIT,crypto:false},Decimal,inexact,noConflict,quadrant,external=true,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",precisionLimitExceeded=decimalError+"Precision limit exceeded",cryptoUnavailable=decimalError+"crypto unavailable",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={name:"[object Decimal]"};P.absoluteValue=P.abs=function(){var x=new this.constructor(this);if(x.s<0)x.s=1;return finalise(x)};P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)};P.comparedTo=P.cmp=function(y){var i,j,xdL,ydL,x=this,xd=x.d,yd=(y=new x.constructor(y)).d,xs=x.s,ys=y.s;if(!xd||!yd){return!xs||!ys?NaN:xs!==ys?xs:xd===yd?0:!xd^xs<0?1:-1}if(!xd[0]||!yd[0])return xd[0]?xs:yd[0]?-ys:0;if(xs!==ys)return xs;if(x.e!==y.e)return x.e>y.e^xs<0?1:-1;xdL=xd.length;ydL=yd.length;for(i=0,j=xdL<ydL?xdL:ydL;i<j;++i){if(xd[i]!==yd[i])return xd[i]>yd[i]^xs<0?1:-1}return xdL===ydL?0:xdL>ydL^xs<0?1:-1};P.cosine=P.cos=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.d)return new Ctor(NaN);if(!x.d[0])return new Ctor(1);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+Math.max(x.e,x.sd())+LOG_BASE;Ctor.rounding=1;x=cosine(Ctor,toLessThanHalfPi(Ctor,x));Ctor.precision=pr;Ctor.rounding=rm;return finalise(quadrant==2||quadrant==3?x.neg():x,pr,rm,true)};P.cubeRoot=P.cbrt=function(){var e,m,n,r,rep,s,sd,t,t3,t3plusx,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);external=false;s=x.s*Math.pow(x.s*x,1/3);if(!s||Math.abs(s)==1/0){n=digitsToString(x.d);e=x.e;if(s=(e-n.length+1)%3)n+=s==1||s==-2?"0":"00";s=Math.pow(n,1/3);e=mathfloor((e+1)/3)-(e%3==(e<0?-1:2));if(s==1/0){n="5e"+e}else{n=s.toExponential();n=n.slice(0,n.indexOf("e")+1)+e}r=new Ctor(n);r.s=x.s}else{r=new Ctor(s.toString())}sd=(e=Ctor.precision)+3;for(;;){t=r;t3=t.times(t).times(t);t3plusx=t3.plus(x);r=divide(t3plusx.plus(x).times(t),t3plusx.plus(t3),sd+2,1);if(digitsToString(t.d).slice(0,sd)===(n=digitsToString(r.d)).slice(0,sd)){n=n.slice(sd-3,sd+1);if(n=="9999"||!rep&&n=="4999"){if(!rep){finalise(t,e+1,0);if(t.times(t).times(t).eq(x)){r=t;break}}sd+=4;rep=1}else{if(!+n||!+n.slice(1)&&n.charAt(0)=="5"){finalise(r,e+1,1);m=!r.times(r).times(r).eq(x)}break}}}external=true;return finalise(r,e,Ctor.rounding,m)};P.decimalPlaces=P.dp=function(){var w,d=this.d,n=NaN;if(d){w=d.length-1;n=(w-mathfloor(this.e/LOG_BASE))*LOG_BASE;w=d[w];if(w)for(;w%10==0;w/=10)n--;if(n<0)n=0}return n};P.dividedBy=P.div=function(y){return divide(this,new this.constructor(y))};P.dividedToIntegerBy=P.divToInt=function(y){var x=this,Ctor=x.constructor;return finalise(divide(x,new Ctor(y),0,1,1),Ctor.precision,Ctor.rounding)};P.equals=P.eq=function(y){return this.cmp(y)===0};P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)};P.greaterThan=P.gt=function(y){return this.cmp(y)>0};P.greaterThanOrEqualTo=P.gte=function(y){var k=this.cmp(y);return k==1||k===0};P.hyperbolicCosine=P.cosh=function(){var k,n,pr,rm,len,x=this,Ctor=x.constructor,one=new Ctor(1);if(!x.isFinite())return new Ctor(x.s?1/0:NaN);if(x.isZero())return one;pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+Math.max(x.e,x.sd())+4;Ctor.rounding=1;len=x.d.length;if(len<32){k=Math.ceil(len/3);n=Math.pow(4,-k).toString()}else{k=16;n="2.3283064365386962890625e-10"}x=taylorSeries(Ctor,1,x.times(n),new Ctor(1),true);var cosh2_x,i=k,d8=new Ctor(8);for(;i--;){cosh2_x=x.times(x);x=one.minus(cosh2_x.times(d8.minus(cosh2_x.times(d8))))}return finalise(x,Ctor.precision=pr,Ctor.rounding=rm,true)};P.hyperbolicSine=P.sinh=function(){var k,pr,rm,len,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+Math.max(x.e,x.sd())+4;Ctor.rounding=1;len=x.d.length;if(len<3){x=taylorSeries(Ctor,2,x,x,true)}else{k=1.4*Math.sqrt(len);k=k>16?16:k|0;x=x.times(Math.pow(5,-k));x=taylorSeries(Ctor,2,x,x,true);var sinh2_x,d5=new Ctor(5),d16=new Ctor(16),d20=new Ctor(20);for(;k--;){sinh2_x=x.times(x);x=x.times(d5.plus(sinh2_x.times(d16.times(sinh2_x).plus(d20))))}}Ctor.precision=pr;Ctor.rounding=rm;return finalise(x,pr,rm,true)};P.hyperbolicTangent=P.tanh=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(x.s);if(x.isZero())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+7;Ctor.rounding=1;return divide(x.sinh(),x.cosh(),Ctor.precision=pr,Ctor.rounding=rm)};P.inverseCosine=P.acos=function(){var halfPi,x=this,Ctor=x.constructor,k=x.abs().cmp(1),pr=Ctor.precision,rm=Ctor.rounding;if(k!==-1){return k===0?x.isNeg()?getPi(Ctor,pr,rm):new Ctor(0):new Ctor(NaN)}if(x.isZero())return getPi(Ctor,pr+4,rm).times(.5);Ctor.precision=pr+6;Ctor.rounding=1;x=x.asin();halfPi=getPi(Ctor,pr+4,rm).times(.5);Ctor.precision=pr;Ctor.rounding=rm;return halfPi.minus(x)};P.inverseHyperbolicCosine=P.acosh=function(){var pr,rm,x=this,Ctor=x.constructor;if(x.lte(1))return new Ctor(x.eq(1)?0:NaN);if(!x.isFinite())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+Math.max(Math.abs(x.e),x.sd())+4;Ctor.rounding=1;external=false;x=x.times(x).minus(1).sqrt().plus(x);external=true;Ctor.precision=pr;Ctor.rounding=rm;return x.ln()};P.inverseHyperbolicSine=P.asinh=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite()||x.isZero())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+2*Math.max(Math.abs(x.e),x.sd())+6;Ctor.rounding=1;external=false;x=x.times(x).plus(1).sqrt().plus(x);external=true;Ctor.precision=pr;Ctor.rounding=rm;return x.ln()};P.inverseHyperbolicTangent=P.atanh=function(){var pr,rm,wpr,xsd,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.e>=0)return new Ctor(x.abs().eq(1)?x.s/0:x.isZero()?x:NaN);pr=Ctor.precision;rm=Ctor.rounding;xsd=x.sd();if(Math.max(xsd,pr)<2*-x.e-1)return finalise(new Ctor(x),pr,rm,true);Ctor.precision=wpr=xsd-x.e;x=divide(x.plus(1),new Ctor(1).minus(x),wpr+pr,1);Ctor.precision=pr+4;Ctor.rounding=1;x=x.ln();Ctor.precision=pr;Ctor.rounding=rm;return x.times(.5)};P.inverseSine=P.asin=function(){var halfPi,k,pr,rm,x=this,Ctor=x.constructor;if(x.isZero())return new Ctor(x);k=x.abs().cmp(1);pr=Ctor.precision;rm=Ctor.rounding;if(k!==-1){if(k===0){halfPi=getPi(Ctor,pr+4,rm).times(.5);halfPi.s=x.s;return halfPi}return new Ctor(NaN)}Ctor.precision=pr+6;Ctor.rounding=1;x=x.div(new Ctor(1).minus(x.times(x)).sqrt().plus(1)).atan();Ctor.precision=pr;Ctor.rounding=rm;return x.times(2)};P.inverseTangent=P.atan=function(){var i,j,k,n,px,t,r,wpr,x2,x=this,Ctor=x.constructor,pr=Ctor.precision,rm=Ctor.rounding;if(!x.isFinite()){if(!x.s)return new Ctor(NaN);if(pr+4<=PI_PRECISION){r=getPi(Ctor,pr+4,rm).times(.5);r.s=x.s;return r}}else if(x.isZero()){return new Ctor(x)}else if(x.abs().eq(1)&&pr+4<=PI_PRECISION){r=getPi(Ctor,pr+4,rm).times(.25);r.s=x.s;return r}Ctor.precision=wpr=pr+10;Ctor.rounding=1;k=Math.min(28,wpr/LOG_BASE+2|0);for(i=k;i;--i)x=x.div(x.times(x).plus(1).sqrt().plus(1));external=false;j=Math.ceil(wpr/LOG_BASE);n=1;x2=x.times(x);r=new Ctor(x);px=x;for(;i!==-1;){px=px.times(x2);t=r.minus(px.div(n+=2));px=px.times(x2);r=t.plus(px.div(n+=2));if(r.d[j]!==void 0)for(i=j;r.d[i]===t.d[i]&&i--;);}if(k)r=r.times(2<<k-1);external=true;return finalise(r,Ctor.precision=pr,Ctor.rounding=rm,true)};P.isFinite=function(){return!!this.d};P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return this.s<0};P.isPositive=P.isPos=function(){return this.s>0};P.isZero=function(){return!!this.d&&this.d[0]===0};P.lessThan=P.lt=function(y){return this.cmp(y)<0};P.lessThanOrEqualTo=P.lte=function(y){return this.cmp(y)<1};P.logarithm=P.log=function(base){var isBase10,d,denominator,k,inf,num,sd,r,arg=this,Ctor=arg.constructor,pr=Ctor.precision,rm=Ctor.rounding,guard=5;if(base==null){base=new Ctor(10);isBase10=true}else{base=new Ctor(base);d=base.d;if(base.s<0||!d||!d[0]||base.eq(1))return new Ctor(NaN);isBase10=base.eq(10)}d=arg.d;if(arg.s<0||!d||!d[0]||arg.eq(1)){return new Ctor(d&&!d[0]?-1/0:arg.s!=1?NaN:d?0:1/0)}if(isBase10){if(d.length>1){inf=true}else{for(k=d[0];k%10===0;)k/=10;inf=k!==1}}external=false;sd=pr+guard;num=naturalLogarithm(arg,sd);denominator=isBase10?getLn10(Ctor,sd+10):naturalLogarithm(base,sd);r=divide(num,denominator,sd,1);if(checkRoundingDigits(r.d,k=pr,rm)){do{sd+=10;num=naturalLogarithm(arg,sd);denominator=isBase10?getLn10(Ctor,sd+10):naturalLogarithm(base,sd);r=divide(num,denominator,sd,1);if(!inf){if(+digitsToString(r.d).slice(k+1,k+15)+1==1e14){r=finalise(r,pr+1,0)}break}}while(checkRoundingDigits(r.d,k+=10,rm))}external=true;return finalise(r,pr,rm)};P.minus=P.sub=function(y){var d,e,i,j,k,len,pr,rm,xd,xe,xLTy,yd,x=this,Ctor=x.constructor;y=new Ctor(y);if(!x.d||!y.d){if(!x.s||!y.s)y=new Ctor(NaN);else if(x.d)y.s=-y.s;else y=new Ctor(y.d||x.s!==y.s?x:NaN);return y}if(x.s!=y.s){y.s=-y.s;return x.plus(y)}xd=x.d;yd=y.d;pr=Ctor.precision;rm=Ctor.rounding;if(!xd[0]||!yd[0]){if(yd[0])y.s=-y.s;else if(xd[0])y=new Ctor(x);else return new Ctor(rm===3?-0:0);return external?finalise(y,pr,rm):y}e=mathfloor(y.e/LOG_BASE);xe=mathfloor(x.e/LOG_BASE);xd=xd.slice();k=xe-e;if(k){xLTy=k<0;if(xLTy){d=xd;k=-k;len=yd.length}else{d=yd;e=xe;len=xd.length}i=Math.max(Math.ceil(pr/LOG_BASE),len)+2;if(k>i){k=i;d.length=1}d.reverse();for(i=k;i--;)d.push(0);d.reverse()}else{i=xd.length;len=yd.length;xLTy=i<len;if(xLTy)len=i;for(i=0;i<len;i++){if(xd[i]!=yd[i]){xLTy=xd[i]<yd[i];break}}k=0}if(xLTy){d=xd;xd=yd;yd=d;y.s=-y.s}len=xd.length;for(i=yd.length-len;i>0;--i)xd[len++]=0;for(i=yd.length;i>k;){if(xd[--i]<yd[i]){for(j=i;j&&xd[--j]===0;)xd[j]=BASE-1;--xd[j];xd[i]+=BASE}xd[i]-=yd[i]}for(;xd[--len]===0;)xd.pop();for(;xd[0]===0;xd.shift())--e;if(!xd[0])return new Ctor(rm===3?-0:0);y.d=xd;y.e=getBase10Exponent(xd,e);return external?finalise(y,pr,rm):y};P.modulo=P.mod=function(y){var q,x=this,Ctor=x.constructor;y=new Ctor(y);if(!x.d||!y.s||y.d&&!y.d[0])return new Ctor(NaN);if(!y.d||x.d&&!x.d[0]){return finalise(new Ctor(x),Ctor.precision,Ctor.rounding)}external=false;if(Ctor.modulo==9){q=divide(x,y.abs(),0,3,1);q.s*=y.s}else{q=divide(x,y,0,Ctor.modulo,1)}q=q.times(y);external=true;return x.minus(q)};P.naturalExponential=P.exp=function(){return naturalExponential(this)};P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)};P.negated=P.neg=function(){var x=new this.constructor(this);x.s=-x.s;return finalise(x)};P.plus=P.add=function(y){var carry,d,e,i,k,len,pr,rm,xd,yd,x=this,Ctor=x.constructor;y=new Ctor(y);if(!x.d||!y.d){if(!x.s||!y.s)y=new Ctor(NaN);else if(!x.d)y=new Ctor(y.d||x.s===y.s?x:NaN);return y}if(x.s!=y.s){y.s=-y.s;return x.minus(y)}xd=x.d;yd=y.d;pr=Ctor.precision;rm=Ctor.rounding;if(!xd[0]||!yd[0]){if(!yd[0])y=new Ctor(x);return external?finalise(y,pr,rm):y}k=mathfloor(x.e/LOG_BASE);e=mathfloor(y.e/LOG_BASE);xd=xd.slice();i=k-e;if(i){if(i<0){d=xd;i=-i;len=yd.length}else{d=yd;e=k;len=xd.length}k=Math.ceil(pr/LOG_BASE);len=k>len?k+1:len+1;if(i>len){i=len;d.length=1}d.reverse();for(;i--;)d.push(0);d.reverse()}len=xd.length;i=yd.length;if(len-i<0){i=len;d=yd;yd=xd;xd=d}for(carry=0;i;){carry=(xd[--i]=xd[i]+yd[i]+carry)/BASE|0;xd[i]%=BASE}if(carry){xd.unshift(carry);++e}for(len=xd.length;xd[--len]==0;)xd.pop();y.d=xd;y.e=getBase10Exponent(xd,e);return external?finalise(y,pr,rm):y};P.precision=P.sd=function(z){var k,x=this;if(z!==void 0&&z!==!!z&&z!==1&&z!==0)throw Error(invalidArgument+z);if(x.d){k=getPrecision(x.d);if(z&&x.e+1>k)k=x.e+1}else{k=NaN}return k};P.round=function(){var x=this,Ctor=x.constructor;return finalise(new Ctor(x),x.e+1,Ctor.rounding)};P.sine=P.sin=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.isZero())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+Math.max(x.e,x.sd())+LOG_BASE;Ctor.rounding=1;x=sine(Ctor,toLessThanHalfPi(Ctor,x));Ctor.precision=pr;Ctor.rounding=rm;return finalise(quadrant>2?x.neg():x,pr,rm,true)};P.squareRoot=P.sqrt=function(){var m,n,sd,r,rep,t,x=this,d=x.d,e=x.e,s=x.s,Ctor=x.constructor;if(s!==1||!d||!d[0]){return new Ctor(!s||s<0&&(!d||d[0])?NaN:d?x:1/0)}external=false;s=Math.sqrt(+x);if(s==0||s==1/0){n=digitsToString(d);if((n.length+e)%2==0)n+="0";s=Math.sqrt(n);e=mathfloor((e+1)/2)-(e<0||e%2);if(s==1/0){n="1e"+e}else{n=s.toExponential();n=n.slice(0,n.indexOf("e")+1)+e}r=new Ctor(n)}else{r=new Ctor(s.toString())}sd=(e=Ctor.precision)+3;for(;;){t=r;r=t.plus(divide(x,t,sd+2,1)).times(.5);if(digitsToString(t.d).slice(0,sd)===(n=digitsToString(r.d)).slice(0,sd)){n=n.slice(sd-3,sd+1);if(n=="9999"||!rep&&n=="4999"){if(!rep){finalise(t,e+1,0);if(t.times(t).eq(x)){r=t;break}}sd+=4;rep=1}else{if(!+n||!+n.slice(1)&&n.charAt(0)=="5"){finalise(r,e+1,1);m=!r.times(r).eq(x)}break}}}external=true;return finalise(r,e,Ctor.rounding,m)};P.tangent=P.tan=function(){var pr,rm,x=this,Ctor=x.constructor;if(!x.isFinite())return new Ctor(NaN);if(x.isZero())return new Ctor(x);pr=Ctor.precision;rm=Ctor.rounding;Ctor.precision=pr+10;Ctor.rounding=1;x=x.sin();x.s=1;x=divide(x,new Ctor(1).minus(x.times(x)).sqrt(),pr+10,0);Ctor.precision=pr;Ctor.rounding=rm;return finalise(quadrant==2||quadrant==4?x.neg():x,pr,rm,true)};P.times=P.mul=function(y){var carry,e,i,k,r,rL,t,xdL,ydL,x=this,Ctor=x.constructor,xd=x.d,yd=(y=new Ctor(y)).d;y.s*=x.s;if(!xd||!xd[0]||!yd||!yd[0]){return new Ctor(!y.s||xd&&!xd[0]&&!yd||yd&&!yd[0]&&!xd?NaN:!xd||!yd?y.s/0:y.s*0)}e=mathfloor(x.e/LOG_BASE)+mathfloor(y.e/LOG_BASE);xdL=xd.length;ydL=yd.length;if(xdL<ydL){r=xd;xd=yd;yd=r;rL=xdL;xdL=ydL;ydL=rL}r=[];rL=xdL+ydL;for(i=rL;i--;)r.push(0);for(i=ydL;--i>=0;){carry=0;for(k=xdL+i;k>i;){t=r[k]+yd[i]*xd[k-i-1]+carry;r[k--]=t%BASE|0;carry=t/BASE|0}r[k]=(r[k]+carry)%BASE|0}for(;!r[--rL];)r.pop();if(carry)++e;else r.shift();y.d=r;y.e=getBase10Exponent(r,e);return external?finalise(y,Ctor.precision,Ctor.rounding):y};P.toBinary=function(sd,rm){return toStringBinary(this,2,sd,rm)};P.toDecimalPlaces=P.toDP=function(dp,rm){var x=this,Ctor=x.constructor;x=new Ctor(x);if(dp===void 0)return x;checkInt32(dp,0,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);return finalise(x,dp+x.e+1,rm)};P.toExponential=function(dp,rm){var str,x=this,Ctor=x.constructor;if(dp===void 0){str=finiteToString(x,true)}else{checkInt32(dp,0,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);x=finalise(new Ctor(x),dp+1,rm);str=finiteToString(x,true,dp+1)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toFixed=function(dp,rm){var str,y,x=this,Ctor=x.constructor;if(dp===void 0){str=finiteToString(x)}else{checkInt32(dp,0,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);y=finalise(new Ctor(x),dp+x.e+1,rm);str=finiteToString(y,false,dp+y.e+1)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toFraction=function(maxD){var d,d0,d1,d2,e,k,n,n0,n1,pr,q,r,x=this,xd=x.d,Ctor=x.constructor;if(!xd)return new Ctor(x);n1=d0=new Ctor(1);d1=n0=new Ctor(0);d=new Ctor(d1);e=d.e=getPrecision(xd)-x.e-1;k=e%LOG_BASE;d.d[0]=mathpow(10,k<0?LOG_BASE+k:k);if(maxD==null){maxD=e>0?d:n1}else{n=new Ctor(maxD);if(!n.isInt()||n.lt(n1))throw Error(invalidArgument+n);maxD=n.gt(d)?e>0?d:n1:n}external=false;n=new Ctor(digitsToString(xd));pr=Ctor.precision;Ctor.precision=e=xd.length*LOG_BASE*2;for(;;){q=divide(n,d,0,1,1);d2=d0.plus(q.times(d1));if(d2.cmp(maxD)==1)break;d0=d1;d1=d2;d2=n1;n1=n0.plus(q.times(d2));n0=d2;d2=d;d=n.minus(q.times(d2));n=d2}d2=divide(maxD.minus(d0),d1,0,1,1);n0=n0.plus(d2.times(n1));d0=d0.plus(d2.times(d1));n0.s=n1.s=x.s;r=divide(n1,d1,e,1).minus(x).abs().cmp(divide(n0,d0,e,1).minus(x).abs())<1?[n1,d1]:[n0,d0];Ctor.precision=pr;external=true;return r};P.toHexadecimal=P.toHex=function(sd,rm){return toStringBinary(this,16,sd,rm)};P.toNearest=function(y,rm){var x=this,Ctor=x.constructor;x=new Ctor(x);if(y==null){if(!x.d)return x;y=new Ctor(1);rm=Ctor.rounding}else{y=new Ctor(y);if(rm===void 0){rm=Ctor.rounding}else{checkInt32(rm,0,8)}if(!x.d)return y.s?x:y;if(!y.d){if(y.s)y.s=x.s;return y}}if(y.d[0]){external=false;x=divide(x,y,0,rm,1).times(y);external=true;finalise(x)}else{y.s=x.s;x=y}return x};P.toNumber=function(){return+this};P.toOctal=function(sd,rm){return toStringBinary(this,8,sd,rm)};P.toPower=P.pow=function(y){var e,k,pr,r,rm,s,x=this,Ctor=x.constructor,yn=+(y=new Ctor(y));if(!x.d||!y.d||!x.d[0]||!y.d[0])return new Ctor(mathpow(+x,yn));x=new Ctor(x);if(x.eq(1))return x;pr=Ctor.precision;rm=Ctor.rounding;if(y.eq(1))return finalise(x,pr,rm);e=mathfloor(y.e/LOG_BASE);if(e>=y.d.length-1&&(k=yn<0?-yn:yn)<=MAX_SAFE_INTEGER){r=intPow(Ctor,x,k,pr);return y.s<0?new Ctor(1).div(r):finalise(r,pr,rm)}s=x.s;if(s<0){if(e<y.d.length-1)return new Ctor(NaN);if((y.d[e]&1)==0)s=1;if(x.e==0&&x.d[0]==1&&x.d.length==1){x.s=s;return x}}k=mathpow(+x,yn);e=k==0||!isFinite(k)?mathfloor(yn*(Math.log("0."+digitsToString(x.d))/Math.LN10+x.e+1)):new Ctor(k+"").e;if(e>Ctor.maxE+1||e<Ctor.minE-1)return new Ctor(e>0?s/0:0);external=false;Ctor.rounding=x.s=1;k=Math.min(12,(e+"").length);r=naturalExponential(y.times(naturalLogarithm(x,pr+k)),pr);if(r.d){r=finalise(r,pr+5,1);if(checkRoundingDigits(r.d,pr,rm)){e=pr+10;r=finalise(naturalExponential(y.times(naturalLogarithm(x,e+k)),e),e+5,1);if(+digitsToString(r.d).slice(pr+1,pr+15)+1==1e14){r=finalise(r,pr+1,0)}}}r.s=s;external=true;Ctor.rounding=rm;return finalise(r,pr,rm)};P.toPrecision=function(sd,rm){var str,x=this,Ctor=x.constructor;if(sd===void 0){str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos)}else{checkInt32(sd,1,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8);x=finalise(new Ctor(x),sd,rm);str=finiteToString(x,sd<=x.e||x.e<=Ctor.toExpNeg,sd)}return x.isNeg()&&!x.isZero()?"-"+str:str};P.toSignificantDigits=P.toSD=function(sd,rm){var x=this,Ctor=x.constructor;if(sd===void 0){sd=Ctor.precision;rm=Ctor.rounding}else{checkInt32(sd,1,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8)}return finalise(new Ctor(x),sd,rm)};P.toString=function(){var x=this,Ctor=x.constructor,str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos);return x.isNeg()&&!x.isZero()?"-"+str:str};P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var x=this,Ctor=x.constructor,str=finiteToString(x,x.e<=Ctor.toExpNeg||x.e>=Ctor.toExpPos);return x.isNeg()?"-"+str:str};function digitsToString(d){var i,k,ws,indexOfLastWord=d.length-1,str="",w=d[0];if(indexOfLastWord>0){str+=w;for(i=1;i<indexOfLastWord;i++){ws=d[i]+"";k=LOG_BASE-ws.length;if(k)str+=getZeroString(k);str+=ws}w=d[i];ws=w+"";k=LOG_BASE-ws.length;if(k)str+=getZeroString(k)}else if(w===0){return"0"}for(;w%10===0;)w/=10;return str+w}function checkInt32(i,min,max){if(i!==~~i||i<min||i>max){throw Error(invalidArgument+i)}}function checkRoundingDigits(d,i,rm,repeating){var di,k,r,rd;for(k=d[0];k>=10;k/=10)--i;if(--i<0){i+=LOG_BASE;di=0}else{di=Math.ceil((i+1)/LOG_BASE);i%=LOG_BASE}k=mathpow(10,LOG_BASE-i);rd=d[di]%k|0;if(repeating==null){if(i<3){if(i==0)rd=rd/100|0;else if(i==1)rd=rd/10|0;r=rm<4&&rd==99999||rm>3&&rd==49999||rd==5e4||rd==0}else{r=(rm<4&&rd+1==k||rm>3&&rd+1==k/2)&&(d[di+1]/k/100|0)==mathpow(10,i-2)-1||(rd==k/2||rd==0)&&(d[di+1]/k/100|0)==0}}else{if(i<4){if(i==0)rd=rd/1e3|0;else if(i==1)rd=rd/100|0;else if(i==2)rd=rd/10|0;r=(repeating||rm<4)&&rd==9999||!repeating&&rm>3&&rd==4999}else{r=((repeating||rm<4)&&rd+1==k||!repeating&&rm>3&&rd+1==k/2)&&(d[di+1]/k/1e3|0)==mathpow(10,i-3)-1}}return r}function convertBase(str,baseIn,baseOut){var j,arr=[0],arrL,i=0,strL=str.length;for(;i<strL;){for(arrL=arr.length;arrL--;)arr[arrL]*=baseIn;arr[0]+=NUMERALS.indexOf(str.charAt(i++));for(j=0;j<arr.length;j++){if(arr[j]>baseOut-1){if(arr[j+1]===void 0)arr[j+1]=0;arr[j+1]+=arr[j]/baseOut|0;arr[j]%=baseOut}}}return arr.reverse()}function cosine(Ctor,x){var k,y,len=x.d.length;if(len<32){k=Math.ceil(len/3);y=Math.pow(4,-k).toString()}else{k=16;y="2.3283064365386962890625e-10"}Ctor.precision+=k;x=taylorSeries(Ctor,1,x.times(y),new Ctor(1));for(var i=k;i--;){var cos2x=x.times(x);x=cos2x.times(cos2x).minus(cos2x).times(8).plus(1)}Ctor.precision-=k;return x}var divide=function(){function multiplyInteger(x,k,base){var temp,carry=0,i=x.length;for(x=x.slice();i--;){temp=x[i]*k+carry;x[i]=temp%base|0;carry=temp/base|0}if(carry)x.unshift(carry);return x}function compare(a,b,aL,bL){var i,r;if(aL!=bL){r=aL>bL?1:-1}else{for(i=r=0;i<aL;i++){if(a[i]!=b[i]){r=a[i]>b[i]?1:-1;break}}}return r}function subtract(a,b,aL,base){var i=0;for(;aL--;){a[aL]-=i;i=a[aL]<b[aL]?1:0;a[aL]=i*base+a[aL]-b[aL]}for(;!a[0]&&a.length>1;)a.shift()}return function(x,y,pr,rm,dp,base){var cmp,e,i,k,logBase,more,prod,prodL,q,qd,rem,remL,rem0,sd,t,xi,xL,yd0,yL,yz,Ctor=x.constructor,sign=x.s==y.s?1:-1,xd=x.d,yd=y.d;if(!xd||!xd[0]||!yd||!yd[0]){return new Ctor(!x.s||!y.s||(xd?yd&&xd[0]==yd[0]:!yd)?NaN:xd&&xd[0]==0||!yd?sign*0:sign/0)}if(base){logBase=1;e=x.e-y.e}else{base=BASE;logBase=LOG_BASE;e=mathfloor(x.e/logBase)-mathfloor(y.e/logBase)}yL=yd.length;xL=xd.length;q=new Ctor(sign);qd=q.d=[];for(i=0;yd[i]==(xd[i]||0);i++);if(yd[i]>(xd[i]||0))e--;if(pr==null){sd=pr=Ctor.precision;rm=Ctor.rounding}else if(dp){sd=pr+(x.e-y.e)+1}else{sd=pr}if(sd<0){qd.push(1);more=true}else{sd=sd/logBase+2|0;i=0;if(yL==1){k=0;yd=yd[0];sd++;for(;(i<xL||k)&&sd--;i++){t=k*base+(xd[i]||0);qd[i]=t/yd|0;k=t%yd|0}more=k||i<xL}else{k=base/(yd[0]+1)|0;if(k>1){yd=multiplyInteger(yd,k,base);xd=multiplyInteger(xd,k,base);yL=yd.length;xL=xd.length}xi=yL;rem=xd.slice(0,yL);remL=rem.length;for(;remL<yL;)rem[remL++]=0;yz=yd.slice();yz.unshift(0);yd0=yd[0];if(yd[1]>=base/2)++yd0;do{k=0;cmp=compare(yd,rem,yL,remL);if(cmp<0){rem0=rem[0];if(yL!=remL)rem0=rem0*base+(rem[1]||0);k=rem0/yd0|0;if(k>1){if(k>=base)k=base-1;prod=multiplyInteger(yd,k,base);prodL=prod.length;remL=rem.length;cmp=compare(prod,rem,prodL,remL);if(cmp==1){k--;subtract(prod,yL<prodL?yz:yd,prodL,base)}}else{if(k==0)cmp=k=1;prod=yd.slice()}prodL=prod.length;if(prodL<remL)prod.unshift(0);subtract(rem,prod,remL,base);if(cmp==-1){remL=rem.length;cmp=compare(yd,rem,yL,remL);if(cmp<1){k++;subtract(rem,yL<remL?yz:yd,remL,base)}}remL=rem.length}else if(cmp===0){k++;rem=[0]}qd[i++]=k;if(cmp&&rem[0]){rem[remL++]=xd[xi]||0}else{rem=[xd[xi]];remL=1}}while((xi++<xL||rem[0]!==void 0)&&sd--);more=rem[0]!==void 0}if(!qd[0])qd.shift()}if(logBase==1){q.e=e;inexact=more}else{for(i=1,k=qd[0];k>=10;k/=10)i++;q.e=i+e*logBase-1;finalise(q,dp?pr+q.e+1:pr,rm,more)}return q}}();function finalise(x,sd,rm,isTruncated){var digits,i,j,k,rd,roundUp,w,xd,xdi,Ctor=x.constructor;out:if(sd!=null){xd=x.d;if(!xd)return x;for(digits=1,k=xd[0];k>=10;k/=10)digits++;i=sd-digits;if(i<0){i+=LOG_BASE;j=sd;w=xd[xdi=0];rd=w/mathpow(10,digits-j-1)%10|0}else{xdi=Math.ceil((i+1)/LOG_BASE);k=xd.length;if(xdi>=k){if(isTruncated){for(;k++<=xdi;)xd.push(0);w=rd=0;digits=1;i%=LOG_BASE;j=i-LOG_BASE+1}else{break out}}else{w=k=xd[xdi];for(digits=1;k>=10;k/=10)digits++;i%=LOG_BASE;j=i-LOG_BASE+digits;rd=j<0?0:w/mathpow(10,digits-j-1)%10|0}}isTruncated=isTruncated||sd<0||xd[xdi+1]!==void 0||(j<0?w:w%mathpow(10,digits-j-1));roundUp=rm<4?(rd||isTruncated)&&(rm==0||rm==(x.s<0?3:2)):rd>5||rd==5&&(rm==4||isTruncated||rm==6&&(i>0?j>0?w/mathpow(10,digits-j):0:xd[xdi-1])%10&1||rm==(x.s<0?8:7));if(sd<1||!xd[0]){xd.length=0;if(roundUp){sd-=x.e+1;xd[0]=mathpow(10,(LOG_BASE-sd%LOG_BASE)%LOG_BASE);x.e=-sd||0}else{xd[0]=x.e=0}return x}if(i==0){xd.length=xdi;k=1;xdi--}else{xd.length=xdi+1;k=mathpow(10,LOG_BASE-i);xd[xdi]=j>0?(w/mathpow(10,digits-j)%mathpow(10,j)|0)*k:0}if(roundUp){for(;;){if(xdi==0){for(i=1,j=xd[0];j>=10;j/=10)i++;j=xd[0]+=k;for(k=1;j>=10;j/=10)k++;if(i!=k){x.e++;if(xd[0]==BASE)xd[0]=1}break}else{xd[xdi]+=k;if(xd[xdi]!=BASE)break;xd[xdi--]=0;k=1}}}for(i=xd.length;xd[--i]===0;)xd.pop()}if(external){if(x.e>Ctor.maxE){x.d=null;x.e=NaN}else if(x.e<Ctor.minE){x.e=0;x.d=[0]}}return x}function finiteToString(x,isExp,sd){if(!x.isFinite())return nonFiniteToString(x);var k,e=x.e,str=digitsToString(x.d),len=str.length;if(isExp){if(sd&&(k=sd-len)>0){str=str.charAt(0)+"."+str.slice(1)+getZeroString(k)}else if(len>1){str=str.charAt(0)+"."+str.slice(1)}str=str+(x.e<0?"e":"e+")+x.e}else if(e<0){str="0."+getZeroString(-e-1)+str;if(sd&&(k=sd-len)>0)str+=getZeroString(k)}else if(e>=len){str+=getZeroString(e+1-len);if(sd&&(k=sd-e-1)>0)str=str+"."+getZeroString(k)}else{if((k=e+1)<len)str=str.slice(0,k)+"."+str.slice(k);if(sd&&(k=sd-len)>0){if(e+1===len)str+=".";str+=getZeroString(k)}}return str}function getBase10Exponent(digits,e){var w=digits[0];for(e*=LOG_BASE;w>=10;w/=10)e++;return e}function getLn10(Ctor,sd,pr){if(sd>LN10_PRECISION){external=true;if(pr)Ctor.precision=pr;throw Error(precisionLimitExceeded)}return finalise(new Ctor(LN10),sd,1,true)}function getPi(Ctor,sd,rm){if(sd>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new Ctor(PI),sd,rm,true)}function getPrecision(digits){var w=digits.length-1,len=w*LOG_BASE+1;w=digits[w];if(w){for(;w%10==0;w/=10)len--;for(w=digits[0];w>=10;w/=10)len++}return len}function getZeroString(k){var zs="";for(;k--;)zs+="0";return zs}function intPow(Ctor,x,n,pr){var isTruncated,r=new Ctor(1),k=Math.ceil(pr/LOG_BASE+4);external=false;for(;;){if(n%2){r=r.times(x);if(truncate(r.d,k))isTruncated=true}n=mathfloor(n/2);if(n===0){n=r.d.length-1;if(isTruncated&&r.d[n]===0)++r.d[n];break}x=x.times(x);truncate(x.d,k)}external=true;return r}function isOdd(n){return n.d[n.d.length-1]&1}function maxOrMin(Ctor,args,ltgt){var y,x=new Ctor(args[0]),i=0;for(;++i<args.length;){y=new Ctor(args[i]);if(!y.s){x=y;break}else if(x[ltgt](y)){x=y}}return x}function naturalExponential(x,sd){var denominator,guard,j,pow,sum,t,wpr,rep=0,i=0,k=0,Ctor=x.constructor,rm=Ctor.rounding,pr=Ctor.precision;if(!x.d||!x.d[0]||x.e>17){return new Ctor(x.d?!x.d[0]?1:x.s<0?0:1/0:x.s?x.s<0?0:x:0/0)}if(sd==null){external=false;wpr=pr}else{wpr=sd}t=new Ctor(.03125);while(x.e>-2){x=x.times(t);k+=5}guard=Math.log(mathpow(2,k))/Math.LN10*2+5|0;wpr+=guard;denominator=pow=sum=new Ctor(1);Ctor.precision=wpr;for(;;){pow=finalise(pow.times(x),wpr,1);denominator=denominator.times(++i);t=sum.plus(divide(pow,denominator,wpr,1));if(digitsToString(t.d).slice(0,wpr)===digitsToString(sum.d).slice(0,wpr)){j=k;while(j--)sum=finalise(sum.times(sum),wpr,1);if(sd==null){if(rep<3&&checkRoundingDigits(sum.d,wpr-guard,rm,rep)){Ctor.precision=wpr+=10;denominator=pow=t=new Ctor(1);i=0;rep++}else{return finalise(sum,Ctor.precision=pr,rm,external=true)}}else{Ctor.precision=pr;return sum}}sum=t}}function naturalLogarithm(y,sd){var c,c0,denominator,e,numerator,rep,sum,t,wpr,x1,x2,n=1,guard=10,x=y,xd=x.d,Ctor=x.constructor,rm=Ctor.rounding,pr=Ctor.precision;if(x.s<0||!xd||!xd[0]||!x.e&&xd[0]==1&&xd.length==1){return new Ctor(xd&&!xd[0]?-1/0:x.s!=1?NaN:xd?0:x)}if(sd==null){external=false;wpr=pr}else{wpr=sd}Ctor.precision=wpr+=guard;c=digitsToString(xd);c0=c.charAt(0);if(Math.abs(e=x.e)<15e14){while(c0<7&&c0!=1||c0==1&&c.charAt(1)>3){x=x.times(y);c=digitsToString(x.d);c0=c.charAt(0);n++}e=x.e;if(c0>1){x=new Ctor("0."+c);e++}else{x=new Ctor(c0+"."+c.slice(1))}}else{t=getLn10(Ctor,wpr+2,pr).times(e+"");x=naturalLogarithm(new Ctor(c0+"."+c.slice(1)),wpr-guard).plus(t);Ctor.precision=pr;return sd==null?finalise(x,pr,rm,external=true):x}x1=x;sum=numerator=x=divide(x.minus(1),x.plus(1),wpr,1);x2=finalise(x.times(x),wpr,1);denominator=3;for(;;){numerator=finalise(numerator.times(x2),wpr,1);t=sum.plus(divide(numerator,new Ctor(denominator),wpr,1));if(digitsToString(t.d).slice(0,wpr)===digitsToString(sum.d).slice(0,wpr)){sum=sum.times(2);if(e!==0)sum=sum.plus(getLn10(Ctor,wpr+2,pr).times(e+""));sum=divide(sum,new Ctor(n),wpr,1);if(sd==null){if(checkRoundingDigits(sum.d,wpr-guard,rm,rep)){Ctor.precision=wpr+=guard;t=numerator=x=divide(x1.minus(1),x1.plus(1),wpr,1);x2=finalise(x.times(x),wpr,1);denominator=rep=1}else{return finalise(sum,Ctor.precision=pr,rm,external=true)}}else{Ctor.precision=pr;return sum}}sum=t;denominator+=2}}function nonFiniteToString(x){return String(x.s*x.s/0)}function parseDecimal(x,str){var e,i,len;if((e=str.indexOf("."))>-1)str=str.replace(".","");if((i=str.search(/e/i))>0){if(e<0)e=i;e+=+str.slice(i+1);str=str.substring(0,i)}else if(e<0){e=str.length}for(i=0;str.charCodeAt(i)===48;i++);for(len=str.length;str.charCodeAt(len-1)===48;--len);str=str.slice(i,len);if(str){len-=i;x.e=e=e-i-1;x.d=[];i=(e+1)%LOG_BASE;if(e<0)i+=LOG_BASE;if(i<len){if(i)x.d.push(+str.slice(0,i));for(len-=LOG_BASE;i<len;)x.d.push(+str.slice(i,i+=LOG_BASE));str=str.slice(i);i=LOG_BASE-str.length}else{i-=len}for(;i--;)str+="0";x.d.push(+str);if(external){if(x.e>x.constructor.maxE){x.d=null;x.e=NaN}else if(x.e<x.constructor.minE){x.e=0;x.d=[0]}}}else{x.e=0;x.d=[0]}return x}function parseOther(x,str){var base,Ctor,divisor,i,isFloat,len,p,xd,xe;if(str==="Infinity"||str==="NaN"){if(!+str)x.s=NaN;x.e=NaN;x.d=null;return x}if(isHex.test(str)){base=16;str=str.toLowerCase()}else if(isBinary.test(str)){base=2}else if(isOctal.test(str)){base=8}else{throw Error(invalidArgument+str)}i=str.search(/p/i);if(i>0){p=+str.slice(i+1);str=str.substring(2,i)}else{str=str.slice(2)}i=str.indexOf(".");isFloat=i>=0;Ctor=x.constructor;if(isFloat){str=str.replace(".","");len=str.length;i=len-i;divisor=intPow(Ctor,new Ctor(base),i,i*2)}xd=convertBase(str,base,BASE);xe=xd.length-1;for(i=xe;xd[i]===0;--i)xd.pop();if(i<0)return new Ctor(x.s*0);x.e=getBase10Exponent(xd,xe);x.d=xd;external=false;if(isFloat)x=divide(x,divisor,len*4);if(p)x=x.times(Math.abs(p)<54?Math.pow(2,p):Decimal.pow(2,p));external=true;return x}function sine(Ctor,x){var k,len=x.d.length;if(len<3)return taylorSeries(Ctor,2,x,x);k=1.4*Math.sqrt(len);k=k>16?16:k|0;x=x.times(Math.pow(5,-k));x=taylorSeries(Ctor,2,x,x);var sin2_x,d5=new Ctor(5),d16=new Ctor(16),d20=new Ctor(20);for(;k--;){sin2_x=x.times(x);x=x.times(d5.plus(sin2_x.times(d16.times(sin2_x).minus(d20))))}return x}function taylorSeries(Ctor,n,x,y,isHyperbolic){var j,t,u,x2,i=1,pr=Ctor.precision,k=Math.ceil(pr/LOG_BASE);external=false;x2=x.times(x);u=new Ctor(y);for(;;){t=divide(u.times(x2),new Ctor(n++*n++),pr,1);u=isHyperbolic?y.plus(t):y.minus(t);y=divide(t.times(x2),new Ctor(n++*n++),pr,1);t=u.plus(y);if(t.d[k]!==void 0){for(j=k;t.d[j]===u.d[j]&&j--;);if(j==-1)break}j=u;u=y;y=t;t=j;i++}external=true;t.d.length=k+1;return t}function toLessThanHalfPi(Ctor,x){var t,isNeg=x.s<0,pi=getPi(Ctor,Ctor.precision,1),halfPi=pi.times(.5);x=x.abs();if(x.lte(halfPi)){quadrant=isNeg?4:1;return x}t=x.divToInt(pi);if(t.isZero()){quadrant=isNeg?3:2}else{x=x.minus(t.times(pi));if(x.lte(halfPi)){quadrant=isOdd(t)?isNeg?2:3:isNeg?4:1;return x}quadrant=isOdd(t)?isNeg?1:4:isNeg?3:2}return x.minus(pi).abs()}function toStringBinary(x,baseOut,sd,rm){var base,e,i,k,len,roundUp,str,xd,y,Ctor=x.constructor,isExp=sd!==void 0;if(isExp){checkInt32(sd,1,MAX_DIGITS);if(rm===void 0)rm=Ctor.rounding;else checkInt32(rm,0,8)}else{sd=Ctor.precision;rm=Ctor.rounding}if(!x.isFinite()){str=nonFiniteToString(x)}else{str=finiteToString(x);i=str.indexOf(".");if(isExp){base=2;if(baseOut==16){sd=sd*4-3}else if(baseOut==8){sd=sd*3-2}}else{base=baseOut}if(i>=0){str=str.replace(".","");y=new Ctor(1);y.e=str.length-i;y.d=convertBase(finiteToString(y),10,base);y.e=y.d.length}xd=convertBase(str,10,base);e=len=xd.length;for(;xd[--len]==0;)xd.pop();if(!xd[0]){str=isExp?"0p+0":"0"}else{if(i<0){e--}else{x=new Ctor(x);x.d=xd;x.e=e;x=divide(x,y,sd,rm,0,base);xd=x.d;e=x.e;roundUp=inexact}i=xd[sd];k=base/2;roundUp=roundUp||xd[sd+1]!==void 0;roundUp=rm<4?(i!==void 0||roundUp)&&(rm===0||rm===(x.s<0?3:2)):i>k||i===k&&(rm===4||roundUp||rm===6&&xd[sd-1]&1||rm===(x.s<0?8:7));xd.length=sd;if(roundUp){for(;++xd[--sd]>base-1;){xd[sd]=0;if(!sd){++e;xd.unshift(1)}}}for(len=xd.length;!xd[len-1];--len);for(i=0,str="";i<len;i++)str+=NUMERALS.charAt(xd[i]);if(isExp){if(len>1){if(baseOut==16||baseOut==8){i=baseOut==16?4:3;for(--len;len%i;len++)str+="0";xd=convertBase(str,base,baseOut);for(len=xd.length;!xd[len-1];--len);for(i=1,str="1.";i<len;i++)str+=NUMERALS.charAt(xd[i])}else{str=str.charAt(0)+"."+str.slice(1)}}str=str+(e<0?"p":"p+")+e}else if(e<0){for(;++e;)str="0"+str;str="0."+str}else{if(++e>len)for(e-=len;e--;)str+="0";else if(e<len)str=str.slice(0,e)+"."+str.slice(e)}}str=(baseOut==16?"0x":baseOut==2?"0b":baseOut==8?"0o":"")+str}return x.s<0?"-"+str:str}function truncate(arr,len){if(arr.length>len){arr.length=len;return true}}function abs(x){return new this(x).abs()}function acos(x){return new this(x).acos()}function acosh(x){return new this(x).acosh()}function add(x,y){return new this(x).plus(y)}function asin(x){return new this(x).asin()}function asinh(x){return new this(x).asinh()}function atan(x){return new this(x).atan()}function atanh(x){return new this(x).atanh()}function atan2(y,x){y=new this(y);x=new this(x);var r,pr=this.precision,rm=this.rounding,wpr=pr+4;if(!y.s||!x.s){r=new this(NaN)}else if(!y.d&&!x.d){r=getPi(this,wpr,1).times(x.s>0?.25:.75);r.s=y.s}else if(!x.d||y.isZero()){r=x.s<0?getPi(this,pr,rm):new this(0);r.s=y.s}else if(!y.d||x.isZero()){r=getPi(this,wpr,1).times(.5);r.s=y.s}else if(x.s<0){this.precision=wpr;this.rounding=1;r=this.atan(divide(y,x,wpr,1));x=getPi(this,wpr,1);this.precision=pr;this.rounding=rm;r=y.s<0?r.minus(x):r.plus(x)}else{r=this.atan(divide(y,x,wpr,1))}return r}function cbrt(x){return new this(x).cbrt()}function ceil(x){return finalise(x=new this(x),x.e+1,2)}function config(obj){if(!obj||typeof obj!=="object")throw Error(decimalError+"Object expected");var i,p,v,useDefaults=obj.defaults===true,ps=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-EXP_LIMIT,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-EXP_LIMIT,0,"modulo",0,9];for(i=0;i<ps.length;i+=3){if(p=ps[i],useDefaults)this[p]=DEFAULTS[p];if((v=obj[p])!==void 0){if(mathfloor(v)===v&&v>=ps[i+1]&&v<=ps[i+2])this[p]=v;else throw Error(invalidArgument+p+": "+v)}}if(p="crypto",useDefaults)this[p]=DEFAULTS[p];if((v=obj[p])!==void 0){if(v===true||v===false||v===0||v===1){if(v){if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes)){this[p]=true}else{throw Error(cryptoUnavailable)}}else{this[p]=false}}else{throw Error(invalidArgument+p+": "+v)}}return this}function cos(x){return new this(x).cos()}function cosh(x){return new this(x).cosh()}function clone(obj){var i,p,ps;function Decimal(v){var e,i,t,x=this;if(!(x instanceof Decimal))return new Decimal(v);x.constructor=Decimal;if(v instanceof Decimal){x.s=v.s;x.e=v.e;x.d=(v=v.d)?v.slice():v;return}t=typeof v;if(t==="number"){if(v===0){x.s=1/v<0?-1:1;x.e=0;x.d=[0];return}if(v<0){v=-v;x.s=-1}else{x.s=1}if(v===~~v&&v<1e7){for(e=0,i=v;i>=10;i/=10)e++;x.e=e;x.d=[v];return}else if(v*0!==0){if(!v)x.s=NaN;x.e=NaN;x.d=null;return}return parseDecimal(x,v.toString())}else if(t!=="string"){throw Error(invalidArgument+v)}if(v.charCodeAt(0)===45){v=v.slice(1);x.s=-1}else{x.s=1}return isDecimal.test(v)?parseDecimal(x,v):parseOther(x,v)}Decimal.prototype=P;Decimal.ROUND_UP=0;Decimal.ROUND_DOWN=1;Decimal.ROUND_CEIL=2;Decimal.ROUND_FLOOR=3;Decimal.ROUND_HALF_UP=4;Decimal.ROUND_HALF_DOWN=5;Decimal.ROUND_HALF_EVEN=6;Decimal.ROUND_HALF_CEIL=7;Decimal.ROUND_HALF_FLOOR=8;Decimal.EUCLID=9;Decimal.config=Decimal.set=config;Decimal.clone=clone;Decimal.isDecimal=isDecimalInstance;Decimal.abs=abs;Decimal.acos=acos;Decimal.acosh=acosh;Decimal.add=add;Decimal.asin=asin;Decimal.asinh=asinh;Decimal.atan=atan;Decimal.atanh=atanh;Decimal.atan2=atan2;Decimal.cbrt=cbrt;Decimal.ceil=ceil;Decimal.cos=cos;Decimal.cosh=cosh;Decimal.div=div;Decimal.exp=exp;Decimal.floor=floor;Decimal.hypot=hypot;Decimal.ln=ln;Decimal.log=log;Decimal.log10=log10;Decimal.log2=log2;Decimal.max=max;Decimal.min=min;Decimal.mod=mod;Decimal.mul=mul;Decimal.pow=pow;Decimal.random=random;Decimal.round=round;Decimal.sign=sign;Decimal.sin=sin;Decimal.sinh=sinh;Decimal.sqrt=sqrt;Decimal.sub=sub;Decimal.tan=tan;Decimal.tanh=tanh;Decimal.trunc=trunc;if(obj===void 0)obj={};if(obj){if(obj.defaults!==true){ps=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"];for(i=0;i<ps.length;)if(!obj.hasOwnProperty(p=ps[i++]))obj[p]=this[p]}}Decimal.config(obj);return Decimal}function div(x,y){return new this(x).div(y)}function exp(x){return new this(x).exp()}function floor(x){return finalise(x=new this(x),x.e+1,3)}function hypot(){var i,n,t=new this(0);external=false;for(i=0;i<arguments.length;){n=new this(arguments[i++]);if(!n.d){if(n.s){external=true;return new this(1/0)}t=n}else if(t.d){t=t.plus(n.times(n))}}external=true;return t.sqrt()}function isDecimalInstance(obj){return obj instanceof Decimal||obj&&obj.name==="[object Decimal]"||false}function ln(x){return new this(x).ln()}function log(x,y){return new this(x).log(y)}function log2(x){return new this(x).log(2)}function log10(x){return new this(x).log(10)}function max(){return maxOrMin(this,arguments,"lt")}function min(){return maxOrMin(this,arguments,"gt")}function mod(x,y){return new this(x).mod(y)}function mul(x,y){return new this(x).mul(y)}function pow(x,y){return new this(x).pow(y)}function random(sd){var d,e,k,n,i=0,r=new this(1),rd=[];if(sd===void 0)sd=this.precision;else checkInt32(sd,1,MAX_DIGITS);k=Math.ceil(sd/LOG_BASE);if(!this.crypto){for(;i<k;)rd[i++]=Math.random()*1e7|0}else if(crypto.getRandomValues){d=crypto.getRandomValues(new Uint32Array(k));for(;i<k;){n=d[i];if(n>=429e7){d[i]=crypto.getRandomValues(new Uint32Array(1))[0]}else{rd[i++]=n%1e7}}}else if(crypto.randomBytes){d=crypto.randomBytes(k*=4);for(;i<k;){n=d[i]+(d[i+1]<<8)+(d[i+2]<<16)+((d[i+3]&127)<<24);if(n>=214e7){crypto.randomBytes(4).copy(d,i)}else{rd.push(n%1e7);i+=4}}i=k/4}else{throw Error(cryptoUnavailable)}k=rd[--i];sd%=LOG_BASE;if(k&&sd){n=mathpow(10,LOG_BASE-sd);rd[i]=(k/n|0)*n}for(;rd[i]===0;i--)rd.pop();if(i<0){e=0;rd=[0]}else{e=-1;for(;rd[0]===0;e-=LOG_BASE)rd.shift();for(k=1,n=rd[0];n>=10;n/=10)k++;if(k<LOG_BASE)e-=LOG_BASE-k}r.e=e;r.d=rd;return r}function round(x){return finalise(x=new this(x),x.e+1,this.rounding)}function sign(x){x=new this(x);return x.d?x.d[0]?x.s:0*x.s:x.s||NaN}function sin(x){return new this(x).sin()}function sinh(x){return new this(x).sinh()}function sqrt(x){return new this(x).sqrt()}function sub(x,y){return new this(x).sub(y)}function tan(x){return new this(x).tan()}function tanh(x){return new this(x).tanh()}function trunc(x){return finalise(x=new this(x),x.e+1,1)}Decimal=clone(DEFAULTS);Decimal["default"]=Decimal.Decimal=Decimal;LN10=new Decimal(LN10);PI=new Decimal(PI);if(typeof define=="function"&&define.amd){define(function(){return Decimal})}else if(typeof module!="undefined"&&module.exports){module.exports=Decimal}else{if(!globalScope){globalScope=typeof self!="undefined"&&self&&self.self==self?self:window}noConflict=globalScope.Decimal;Decimal.noConflict=function(){globalScope.Decimal=noConflict;return Decimal};globalScope.Decimal=Decimal}})(this)},{}],16:[function(require,module,exports){"use strict";var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;module.exports=function(str){if(typeof str!=="string"){throw new TypeError("Expected a string")}return str.replace(matchOperatorsRe,"\\$&")}},{}],17:[function(require,module,exports){if(!String.fromCodePoint){(function(){var defineProperty=function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}();var stringFromCharCode=String.fromCharCode;var floor=Math.floor;var fromCodePoint=function(_){var MAX_SIZE=16384;var codeUnits=[];var highSurrogate;var lowSurrogate;var index=-1;var length=arguments.length;if(!length){return""}var result="";while(++index<length){var codePoint=Number(arguments[index]);if(!isFinite(codePoint)||codePoint<0||codePoint>1114111||floor(codePoint)!=codePoint){throw RangeError("Invalid code point: "+codePoint)}if(codePoint<=65535){codeUnits.push(codePoint)}else{codePoint-=65536;highSurrogate=(codePoint>>10)+55296;lowSurrogate=codePoint%1024+56320;codeUnits.push(highSurrogate,lowSurrogate)}if(index+1==length||codeUnits.length>MAX_SIZE){result+=stringFromCharCode.apply(null,codeUnits);codeUnits.length=0}}return result};if(defineProperty){defineProperty(String,"fromCodePoint",{value:fromCodePoint,configurable:true,writable:true})}else{String.fromCodePoint=fromCodePoint}})()}},{}],18:[function(require,module,exports){"use strict";module.exports={stdout:false,stderr:false}},{}],19:[function(require,module,exports){(function(root,factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{root.treeify=factory()}})(this,function(){function makePrefix(key,last){var str=last?"â””":"â”œ";if(key){str+="â”€ "}else{str+="â”€â”€â”"}return str}function filterKeys(obj,hideFunctions){var keys=[];for(var branch in obj){if(!obj.hasOwnProperty(branch)){continue}if(hideFunctions&&typeof obj[branch]==="function"){continue}keys.push(branch)}return keys}function growBranch(key,root,last,lastStates,showValues,hideFunctions,callback){var line="",index=0,lastKey,circular,lastStatesCopy=lastStates.slice(0);if(lastStatesCopy.push([root,last])&&lastStates.length>0){lastStates.forEach(function(lastState,idx){if(idx>0){line+=(lastState[1]?" ":"â”‚")+"  "}if(!circular&&lastState[0]===root){circular=true}});line+=makePrefix(key,last)+key;showValues&&(typeof root!=="object"||root instanceof Date)&&(line+=": "+root);circular&&(line+=" (circular ref.)");callback(line)}if(!circular&&typeof root==="object"){var keys=filterKeys(root,hideFunctions);keys.forEach(function(branch){lastKey=++index===keys.length;growBranch(branch,root[branch],lastKey,lastStatesCopy,showValues,hideFunctions,callback)})}}var Treeify={};Treeify.asLines=function(obj,showValues,hideFunctions,lineCallback){var hideFunctionsArg=typeof hideFunctions!=="function"?hideFunctions:false;growBranch(".",obj,false,[],showValues,hideFunctionsArg,lineCallback||hideFunctions)};Treeify.asTree=function(obj,showValues,hideFunctions){var tree="";growBranch(".",obj,false,[],showValues,hideFunctions,function(line){tree+=line+"\n"});return tree};return Treeify})},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});require("string.fromcodepoint");var jsEscapeRegex=/\\(u\{([0-9A-Fa-f]+)\}|u([0-9A-Fa-f]{4})|x([0-9A-Fa-f]{2})|([1-7][0-7]{0,2}|[0-7]{2,3})|(['"tbrnfv0\\]))|\\U([0-9A-Fa-f]{8})/g;var usualEscapeSequences={0:"\0",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v","'":"'",'"':'"',"\\":"\\"};var fromHex=function fromHex(str){return String.fromCodePoint(parseInt(str,16))};var fromOct=function fromOct(str){return String.fromCodePoint(parseInt(str,8))};exports.default=function(string){return string.replace(jsEscapeRegex,function(_,__,varHex,longHex,shortHex,octal,specialCharacter,python){if(varHex!==undefined){return fromHex(varHex)}else if(longHex!==undefined){return fromHex(longHex)}else if(shortHex!==undefined){return fromHex(shortHex)}else if(octal!==undefined){return fromOct(octal)}else if(python!==undefined){return fromHex(python)}else{return usualEscapeSequences[specialCharacter]}})};module.exports=exports["default"]},{"string.fromcodepoint":17}],21:[function(require,module,exports){const helpers={isOneOf:function(token,list){return list.includes(token.name)},isWrapped:function(start,expected,end,i,tokens,parser){const start_i=i;if(!helpers.isOneOf(tokens[i],[start])){return-1}i+=1;while(!helpers.isOneOf(tokens[i],[end,start])){i+=1;if(i>tokens.length-1){return-1}}if(helpers.isOneOf(tokens[i],[start])){return-1}var grabbed_tokens=tokens.slice(start_i+1,i);grabbed_tokens.push({name:"eof"});var match=parser("",grabbed_tokens,true);if(!match[0]){return-1}if(helpers.isOneOf(match[1][0],[expected])){return[i+1,[match[1][0]]]}return-1},isSeq:function(seq,i,tokens){for(var rule in seq){if(seq.hasOwnProperty(rule)){rule=seq[rule];if(typeof rule.name!=typeof[]){rule.name=[rule.name]}if(rule.not_after){var j=i-1;while(j>0&&tokens[j].name=="_"){j--}if(j>0&&rule.not_after.includes(tokens[j].name)){return-1}}if(rule.not_before){var j=i+1;while(j<tokens.length&&tokens[j].name=="_"){j++}if(j<=tokens.length&&rule.not_before.includes(tokens[j].name)){return-1}}if(rule.should_be_after){var j=i-1;while(j>0&&tokens[j].name=="_"){j--}if(j<0||!rule.should_be_after.includes(tokens[j].name)){return-1}}if(rule.count>=1){var count=rule.count;while(count>0){var name_match=true;if(rule.raw&&rule.raw!=tokens[i].raw){name_match=false}if(name_match&&helpers.isOneOf(tokens[i],rule.name)){i+=1;count-=1}else{if(rule.opt!=true){return-1}if(rule.fail&&helpers.isOneOf(tokens[i],rule.fail)){return-1}count-=1}}}else if(rule.count<=0){if(rule.sep!=undefined){var _i=helpers.grabAllUntil(tokens,i,rule.name,rule.sep,rule.enders);if(rule.count==-1){if(_i-i==1){return-1}}if(_i>i){i=_i}else if(_i==-1){if(rule.opt!=true){return-1}}}else{var res=helpers.isOneOf(tokens[i],rule.name);if(res){while(helpers.isOneOf(tokens[i],rule.name)){i+=1}}else{if(rule.opt!=true){return-1}}}}}}return i},grabAllUntil:function(tokens,i,list,sep,enders){var initial_i=i;var one_matched=false;while(true){var curr_tok=tokens[i];if(helpers.isOneOf(curr_tok,sep)){i+=1}else if(helpers.isOneOf(curr_tok,list)){one_matched=true;i+=1}else if(!enders.length||helpers.isOneOf(curr_tok,enders)){while(i>0&&helpers.isOneOf(tokens[i-1],sep)){i-=1}if(!one_matched){return-1}return i}else{return-1}}},wrapAs:function(name,start,end,tokens,res_tokens){if(res_tokens!==undefined){var result={name:name,index:tokens[start].index,tokens:res_tokens}}else{var non_importants_raw=["_","_n","^","map","set","indent","dedent","filt","not","proc","import","from","lbra","rbra","colon","if","else","elif","fn","lpar","rpar","dot","comma","type","of","as"];var non_importants_token=["starmap"];var res_tokens=tokens.slice(start,end).filter(function(obj){if(non_importants_raw.includes(obj.name)&&obj.raw!=undefined){return false}if(non_importants_token.includes(obj.name)){return false}return true});var result={name:name,index:tokens[start].index,tokens:res_tokens}}var head=tokens.slice(0,start);head.push(result);var tail=tokens.slice(end);var body=head.concat(tail);return body}};module.exports=helpers},{}],22:[function(require,module,exports){const throw_error=require("../common").throw_error;const helpers=require("./helpers");const{matchers:matchers,illegals:illegals}=require("../syntax/parsing");function parser(contents,tokens,silent){var ast=[];var match,matched;var res_tokens;var all_matchers=Object.keys(matchers);var i=0;var j=0;while(true){matched=false;var matcher=all_matchers[j];i=0;while(true){res_tokens=undefined;match=matchers[matcher](i,tokens,parser);if(match.constructor===Array){res_tokens=match[1];match=match[0]}if(match>i){tokens=helpers.wrapAs(matcher,i,match,tokens,res_tokens);matched=true;i=0;j=-1;break}if(i==tokens.length-1){break}i++}if(j==all_matchers.length-1){if(!matched){break}}j++}var result=true;for(var i=0;i<tokens.length;i++){if(illegals.includes(tokens[i].name)){if(!silent){throw_error(contents,`Unexpected token '${tokens[i].name}'`,tokens[i].index)}result=false;break}}if(result){tokens=tokens.filter(function(token){return!["_","_n","^"].includes(token.name)})}return[result,tokens]}module.exports=parser},{"../common":2,"../syntax/parsing":24,"./helpers":21}],23:[function(require,module,exports){const patterns={string:/^'([^\\]|\\.)*?'/,word:/^#[^\[\] \r\n:]+/i,number:/^(0|-?[1-9][0-9']*)(\.[0-9']+)?/,possesive:/^(my|[a-zA-Z$][a-zA-Z0-9_$-]*'s?)/,fn:/^fn(?![a-zA-Z_-])/,return:/^return(?![a-zA-Z_-])/,if:/^if(?![a-zA-Z_-])/,elif:/^elif(?![a-zA-Z_-])/,else:/^else(?![a-zA-Z_-])/,bool:/^(true|false)(?![a-zA-Z_-])/,transform:/^transform(?![a-zA-Z_-])/,and:/^and(?![a-zA-Z_-])/,or:/^or(?![a-zA-Z_-])/,not:/^not(?![a-zA-Z_-])/,of:/^of(?![a-zA-Z_-])/,type:/^type(?![a-zA-Z_-])/,as:/^as(?![a-zA-Z_-])/,import:/^import(?![a-zA-Z_-])/,from:/^from(?![a-zA-Z_-])/,url:/^https?:[^ \r\n]+/,comment:/^ *--[^\r\n]+/,symbol:/^[a-z$_][a-z_0-9$-]*/i,map:/^->/,set:/^=>/,filt:/^\|/,comparison:/^(!=|>=|<=|>|<|=)/,dsop:/^[\^]/,sop:/^[*/]/,op:/^[-+%]/,dot:/^[.]/,atsign:/^[@]/,lbra:/^[\[]/,rbra:/^[\]]/,lpar:/^[\(]/,rpar:/^[\)]/,emptyline:/^(\r?\n[ \t\f]*\r?\n)+/,comma:/^,/,colon:/^:/,_n:/^\r?\n/,_:/^ +/};module.exports=patterns},{}],24:[function(require,module,exports){const helpers=require("../parser/helpers");const matchers={wrapped_decorator:function(i,tokens,parser){return helpers.isWrapped("lpar","decorator","rpar",i,tokens,parser)},wrapped_math:function(i,tokens,parser){return helpers.isWrapped("lpar","math","rpar",i,tokens,parser)},wrapped_flow:function(i,tokens,parser){return helpers.isWrapped("lpar","flow","rpar",i,tokens,parser)},wrapped_quickfundef:function(i,tokens,parser){return helpers.isWrapped("lpar","quickfundef","rpar",i,tokens,parser)},transform:function(i,tokens,parser){return helpers.isWrapped("lpar","naked_transform","rpar",i,tokens,parser)},startransform:function(i,tokens,parser){return helpers.isWrapped("lpar","naked_startransform","rpar",i,tokens,parser)},wrapped_and_or:function(i,tokens,parser){return helpers.isWrapped("lpar","and_or_expr","rpar",i,tokens,parser)},wrapped_not:function(i,tokens,parser){return helpers.isWrapped("lpar","notexpr","rpar",i,tokens,parser)},naked_startransform:function(i,tokens){return helpers.isSeq([{name:"sop",count:1,raw:"*"},{name:"_",count:1,opt:true},{name:"naked_transform",count:1}],i,tokens)},of_something:function(i,tokens){return helpers.isSeq([{name:"of",count:1},{name:"_",count:0},{name:"symbol",count:1}],i,tokens)},slice:(i,tokens)=>helpers.isSeq([{name:["symbol","list","range"],count:1},{name:["list"],count:0,enders:[]}],i,tokens),property_access:(i,tokens)=>helpers.isSeq([{name:"possesive",count:1},{name:"_",count:0},{name:["possesive","symbol"],count:0,sep:["_"],enders:[]}],i,tokens),atnumber:function(i,tokens){return helpers.isSeq([{name:"atsign",count:1},{name:"number",count:1}],i,tokens)},from_st:function(i,tokens){return helpers.isSeq([{name:"from",count:1},{name:"_",count:0},{name:["url","symbol","property_access","path"],count:1}],i,tokens)},import_st:function(i,tokens){return helpers.isSeq([{name:"import",count:1},{name:"_",count:0},{name:["symbol","property_access"],count:0,sep:["_","^","_n"],enders:["from_st"]},{name:"_",count:0,opt:true},{name:"from_st",count:1}],i,tokens)},import_nk:function(i,tokens){return helpers.isSeq([{name:"import",count:1},{name:"_",count:0},{name:["symbol","property_access","property_access"],count:0,sep:["_"],enders:["_n"]}],i,tokens)},import_al:function(i,tokens){return helpers.isSeq([{name:"import",count:1},{name:"_",count:0},{name:"sop",count:1},{name:"_",count:0},{name:"from_st",count:1,opt:true}],i,tokens)},starmap:function(i,tokens,parser){return helpers.isSeq([{name:"map",count:1},{name:"_",count:0,opt:true},{name:"sop",count:1,raw:"*"}],i,tokens)},range_start:function(i,tokens,parser){return helpers.isSeq([{name:"lbra",count:1},{name:["number","symbol","wrapped_math"],count:1,opt:true},{name:"colon",count:1}],i,tokens)},stepped_range:function(i,tokens,parser){return helpers.isSeq([{name:"range_start",count:1},{name:["number","symbol","wrapped_math"],count:1,opt:true},{name:"colon",count:1},{name:["number","symbol","wrapped_math"],count:1},{name:"rbra",count:1}],i,tokens)},range:function(i,tokens,parser){return helpers.isSeq([{name:"range_start",count:1},{name:["number","symbol","wrapped_math"],count:1,opt:true},{name:"rbra",count:1}],i,tokens)},dsop_math:function(i,tokens,parser){return helpers.isSeq([{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow","range","stepped_range","list"],count:1},{name:["_"],count:0,opt:true},{name:"dsop",count:1},{name:["_"],count:0,opt:true},{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow"],count:1}],i,tokens)},sop_math:function(i,tokens,parser){return helpers.isSeq([{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow","range","stepped_range","list"],count:1},{name:["_"],count:0,opt:true},{name:"sop",count:1},{name:["_"],count:0,opt:true},{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow"],count:1}],i,tokens)},op_math:function(i,tokens,parser){return helpers.isSeq([{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow","range","stepped_range","list","string","word"],count:1},{name:["_"],count:0,opt:true},{name:"op",count:1},{name:["_"],count:0,opt:true},{name:["symbol","property_access","number","wrapped_math","math","wrapped_flow","string","word"],count:1}],i,tokens)},math:function(i,tokens,parser){return helpers.isOneOf(tokens[i],["dsop_math","sop_math","op_math"])?i+1:-1},atnum_as:function(i,tokens){return helpers.isSeq([{name:"atnumber",count:1},{name:"_",count:1},{name:"as",count:1},{name:"_",count:1},{name:"symbol",count:1}],i,tokens)},naked_transform:function(i,tokens){return helpers.isSeq([{name:"transform",count:1},{name:"_",count:1},{name:["symbol","atnum_as"],count:1},{name:"_",count:1,opt:true},{name:"colon",count:1},{name:"_",count:1,opt:true},{name:["math","wrapped_math","symbol","property_access","number","bool","cmpexpr","and_or_expr","wrapped_and_or","notexpr","wrapped_not"],count:1,not_before:["comparison"]}],i,tokens)},list:function(i,tokens){return helpers.isSeq([{name:"lbra",count:1},{name:["symbol","property_access","number","list","empty_list","string","word","bool","wrapped_math","range","stepped_range"],count:0,sep:["_","_n","^","indent","dedent"],enders:["rbra","lbra"]},{name:"rbra",count:1}],i,tokens)},empty_list:function(i,tokens){return helpers.isSeq([{name:"lbra",count:1},{name:"rbra",count:1}],i,tokens)},decorated_inflowfundef:function(i,tokens){return helpers.isSeq([{name:["_","^","_n"],count:1},{name:"map",count:1},{name:"_",count:1},{name:"wrapped_decorator",count:0,sep:["_"],enders:["fn"]},{name:"_",count:1},{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},inflowfundef:function(i,tokens){return helpers.isSeq([{name:["_","^","_n"],count:1},{name:"map",count:1},{name:"_",count:1},{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},decorated_starinflowfundef:function(i,tokens){return helpers.isSeq([{name:["_","^","_n"],count:1},{name:"starmap",count:1},{name:"_",count:1},{name:"wrapped_decorator",count:0,sep:["_"],enders:["fn"]},{name:"_",count:1},{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:1,opt:true},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},starinflowfundef:function(i,tokens){return helpers.isSeq([{name:["_","^","_n"],count:1},{name:"starmap",count:1},{name:"_",count:1,opt:true},{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:1,opt:true},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},decorator:function(i,tokens){return helpers.isSeq([{name:"atsign",count:1},{name:["symbol","property_access"],count:1},{name:"_",count:1,opt:true},{name:["symbol","property_access","number","list"],sep:["_"],count:0,enders:["_n"],opt:true}],i,tokens)},fundef:function(i,tokens){return helpers.isSeq([{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:1},{name:"symbol",sep:["_"],count:0,enders:["colon"]},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},fundefif:function(i,tokens){return helpers.isSeq([{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:1},{name:"symbol",sep:["_"],count:0,enders:["if"]},{name:"_",count:0},{name:"if",count:1},{name:"_",count:0},{name:["if_fun_call","symbol"],count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},fundefof:function(i,tokens){return helpers.isSeq([{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:0},{name:"symbol",sep:["_"],count:0,enders:["of_something"],opt:true},{name:"_",count:0,opt:true},{name:"of_something",count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},fundefifof:function(i,tokens){return helpers.isSeq([{name:"fn",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:0},{name:"symbol",sep:["_"],count:0,enders:["if"],opt:true},{name:"_",count:0},{name:"if",count:1},{name:"_",count:1},{name:["if_fun_call","symbol"],count:1},{name:"_",count:0,opt:true},{name:"of_something",count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},typedef:function(i,tokens){return helpers.isSeq([{name:"type",count:1},{name:"_",count:1},{name:"symbol",count:1},{name:"_",count:1},{name:"symbol",sep:["_"],count:0,enders:["colon"]},{name:"colon",count:1},{name:"_n",count:0},{name:"block",count:1}],i,tokens)},decorated_fundef:function(i,tokens){return helpers.isSeq([{name:"decorator",count:0,sep:["_","^","_n"],enders:["fundef"]},{name:["_","^","_n"],count:0},{name:"fundef",count:1}],i,tokens)},decorated_fundefif:function(i,tokens){return helpers.isSeq([{name:"decorator",count:0,sep:["_","^","_n"],enders:["fundefif"]},{name:["_","^","_n"],count:0},{name:"fundefif",count:1}],i,tokens)},decorated_fundefof:function(i,tokens){return helpers.isSeq([{name:"decorator",count:0,sep:["_","^","_n"],enders:["fundefof"]},{name:["_","^","_n"],count:0},{name:"fundefof",count:1}],i,tokens)},decorated_fundefifof:function(i,tokens){return helpers.isSeq([{name:"decorator",count:0,sep:["_","^","_n"],enders:["fundefifof"]},{name:["_","^","_n"],count:0},{name:"fundefifof",count:1}],i,tokens)},quickfundef:function(i,tokens){return helpers.isSeq([{name:"symbol",count:1,not_after:["transform","as"]},{name:"_",count:1,opt:true},{name:"colon",count:1},{name:"_",count:1,opt:true},{name:["math","wrapped_math","cmpexpr","and_or_expr","wrapped_and_or","notexpr","wrapped_not","list","bool","string","word"],count:1}],i,tokens)},if_fun_call:function(i,tokens){return helpers.isSeq([{name:["symbol","property_access"],count:1,should_be_after:["if","elif"]},{name:"_",count:0},{name:["symbol","property_access","atsign","atnumber","number","list","bool","wrapped_flow","wrapped_math","string","word","empty_list","transform","startransform","wrapped_quickfundef"],count:0,sep:["_"],enders:["colon","comparison","map","set"]}],i,tokens)},setter:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"set",count:1},{name:"_",count:1},{name:["symbol","property_access","slice"],count:1}],i,tokens)},starmapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"starmap",count:1},{name:"_",count:1},{name:["symbol","property_access","quickfundef"],count:1},{name:"_",count:1},{name:["symbol","property_access","atsign","atnumber","number","list","bool","wrapped_flow","wrapped_math","string","word","empty_list","transform","startransform","wrapped_quickfundef"],count:0,sep:["_"],enders:["colon","_n","map","set","mapper","starmapper","naked_mapper","naked_star_mapper","setter","dedent","rpar","starmap"]}],i,tokens)},mapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"map",count:1},{name:"_",count:1},{name:["symbol","property_access","quickfundef"],count:1},{name:"_",count:1},{name:["symbol","property_access","atsign","atnumber","number","list","bool","wrapped_flow","wrapped_math","string","word","empty_list","transform","startransform","wrapped_quickfundef"],count:0,sep:["_"],enders:["colon","_n","map","set","mapper","starmapper","naked_mapper","naked_star_mapper","setter","dedent","rpar","comparison"]}],i,tokens)},condmapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"map",count:1},{name:["_","_n","^"],count:0},{name:"conditional",count:1}],i,tokens)},starcondmapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"starmap",count:1},{name:["_","_n","^"],count:0},{name:"conditional",count:1}],i,tokens)},return_mapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"map",count:1},{name:"_",count:1},{name:"return",count:1}],i,tokens)},naked_star_mapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"starmap",count:1},{name:"_",count:1},{name:["symbol","property_access","anonfundef","quickfundef"],count:1},{fail:["symbol","property_access","transform","startransform"],skip:["_"]}],i,tokens)},naked_mapper:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:"map",count:1},{name:"_",count:1},{name:["symbol","property_access","anonfundef","quickfundef"],count:1},{fail:["symbol","property_access","transform","startransform"],skip:["_"]}],i,tokens)},block:function(i,tokens){return helpers.isSeq([{name:"indent",count:1},{name:["_","^"],count:0},{name:["block","conditional","flow","fundef","anonfundef","list","string","word","number","symbol","property_access","bool","math","procdef","range","typedef","fundefof","notexpr","slice"],count:0,sep:["_","_n","^"],enders:["dedent"]},{name:["_n","^"],count:0,opt:true},{name:"dedent",count:1}],i,tokens)},if_statement:function(i,tokens){return helpers.isSeq([{name:"if",count:1},{name:"_",count:0,opt:true},{name:["halfcmp","flow","symbol","property_access","cmpexpr","and_or_expr","wrapped_and_or","notexpr","wrapped_not","if_fun_call","math"],count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:["_","_n","^"],count:0},{name:["block","string","word","number","list","symbol","property_access","self_property_access","math","slice","notexpr"],count:1}],i,tokens)},elif_statement:function(i,tokens){return helpers.isSeq([{name:"elif",count:1},{name:"_",count:0},{name:["halfcmp","flow","symbol","property_access","cmpexpr","and_or_expr","wrapped_and_or","notexpr","wrapped_not","if_fun_call","math"],count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:["_","_n","^"],count:0},{name:["block","string","word","number","list","symbol","property_access","self_property_access","math","slice","notexpr"],count:1}],i,tokens)},else_statement:function(i,tokens){return helpers.isSeq([{name:"else",count:1},{name:"_",count:0,opt:true},{name:"colon",count:1},{name:["_","_n","^"],count:0},{name:["block","string","word","number","list","symbol","property_access","self_property_access","math","slice","notexpr"],count:1}],i,tokens)},flow:function(i,tokens){return helpers.isSeq([{name:["symbol","property_access","list","empty_list","slice","range","stepped_range","string","word","number","bool","wrapped_flow","math","if_fun_call","wrapped_math","atsign","slice","notexpr"],count:0,sep:["_"],enders:["setter","mapper","starmapper","naked_mapper","naked_star_mapper","_n","^","filter","starinflowfundef","decorated_starinflowfundef","inflowfundef","decorated_inflowfundef","starinflowprocdef","inflowprocdef","condmapper","starcondmapper","quickfundef","starquickfundef","return_mapper"],not_after:["not"]},{name:["setter","mapper","starmapper","naked_mapper","naked_star_mapper","filter","starinflowfundef","decorated_starinflowfundef","inflowfundef","decorated_inflowfundef","starinflowprocdef","inflowprocdef","condmapper","starcondmapper","quickfundef","starquickfundef","return_mapper"],count:0,sep:["_","_n","^"],enders:["colon","_n","^","symbol","property_access","list","number","bool","empty_list","range","stepped_range","string","math","wrapped_math","notexpr","slice","word","dedent","eof","flow","conditional","rpar","fundef","comparison","procdef","decorator","import_st","import_nk","import_al","typedef","fundefof","fundefif","fundefifof"]}],i,tokens)},cmpexpr:function(i,tokens){return helpers.isSeq([{name:["if_fun_call","number","symbol","property_access","string","word","flow","wrapped_flow","wrapped_math"],count:1},{name:["_","^"],count:0},{name:["comparison"],count:1},{name:["_","^"],count:0},{name:["number","symbol","property_access","string","word","flow","wrapped_flow","wrapped_math","bool"],count:1}],i,tokens)},halfcmp:function(i,tokens){return helpers.isSeq([{name:["comparison"],count:1},{name:["_","^"],count:0},{name:["number","symbol","property_access","string","word","wrapped_flow","wrapped_math","flow","bool"],count:1}],i,tokens)},notexpr:function(i,tokens){return helpers.isSeq([{name:["not"],count:1},{name:["_"],count:0},{name:["cmpexpr","string","symbol","property_access","list","word","wrapped_flow","wrapped_math","and_or_expr","wrapped_and_or","notexpr","wrapped_not","bool","slice","math"],count:1}],i,tokens)},and_or_expr:function(i,tokens){return helpers.isSeq([{name:["cmpexpr","string","symbol","property_access","list","word","wrapped_flow","wrapped_math","and_or_expr","wrapped_and_or","notexpr","wrapped_not","bool","slice","math"],count:1},{name:["_"],count:0},{name:["and","or"],count:1},{name:["_"],count:0},{name:["cmpexpr","string","symbol","property_access","list","word","wrapped_flow","wrapped_math","and_or_expr","wrapped_and_or","notexpr","wrapped_not","bool","slice","math"],count:1}],i,tokens)},conditional:function(i,tokens){return helpers.isSeq([{name:"if_statement",count:1},{name:["_","_n","^"],count:0,opt:true},{name:"elif_statement",count:0,opt:true,fail:["elif"],sep:["_n","_","^"],enders:[]},{name:["_","_n","^"],count:0,opt:true},{name:"else_statement",count:1,opt:true,fail:["else"]}],i,tokens)},eof:function(i,tokens){return helpers.isSeq([{name:["_","_n","^"],count:0},{name:["eof"],count:1}],i,tokens)}};const illegals=["map","set","return","fn","if","elif","else","dot","star","lbra","rbra","comma","colon","starmap"];exports.illegals=illegals;exports.matchers=matchers},{"../parser/helpers":21}],25:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}]},{},[1]);
